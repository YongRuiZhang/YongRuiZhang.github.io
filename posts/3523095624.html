<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0"><title>数论基础 | 秋白's Blog</title><meta name="author" content="秋白"><meta name="copyright" content="秋白"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="数据结构和算法中的数论基础。主要包含质数、约数、欧拉函数、快速幂、扩展欧几里得算法、中国剩余定理、高斯消元、组合数、容斥定理、简单博弈论">
<meta property="og:type" content="article">
<meta property="og:title" content="数论基础">
<meta property="og:url" content="http://yongruizhang.cn/posts/3523095624.html">
<meta property="og:site_name" content="秋白&#39;s Blog">
<meta property="og:description" content="数据结构和算法中的数论基础。主要包含质数、约数、欧拉函数、快速幂、扩展欧几里得算法、中国剩余定理、高斯消元、组合数、容斥定理、简单博弈论">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://zyr-blog-image.oss-cn-beijing.aliyuncs.com/img102.jpg">
<meta property="article:published_time" content="2024-02-18T05:25:58.000Z">
<meta property="article:modified_time" content="2024-02-19T05:31:29.955Z">
<meta property="article:author" content="秋白">
<meta property="article:tag" content="数据结构和算法">
<meta property="article:tag" content="C++">
<meta property="article:tag" content="数论">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://zyr-blog-image.oss-cn-beijing.aliyuncs.com/img102.jpg"><link rel="shortcut icon" href="https://zyr-blog-image.oss-cn-beijing.aliyuncs.com/img/blog-img-main/favicon.png"><link rel="canonical" href="http://yongruizhang.cn/posts/3523095624.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: {"path":"/search.xml","preload":false,"languages":{"hits_empty":"找不到您查询的内容：${query}"}},
  translate: {"defaultEncoding":2,"translateDelay":0,"msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"簡"},
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":false,"highlightHeightLimit":500},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '天',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: {"chs_to_cht":"你已切换为繁体","cht_to_chs":"你已切换为简体","day_to_night":"你已切换为深色模式","night_to_day":"你已切换为浅色模式","bgLight":"#49b1f5","bgDark":"#1f1f1f","position":"bottom-left"},
  source: {
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: true,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: true,
  }
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: '数论基础',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2024-02-19 13:31:29'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
    win.getCSS = url => new Promise((resolve, reject) => {
      const link = document.createElement('link')
      link.rel = 'stylesheet'
      link.href = url
      link.onload = () => resolve()
      link.onerror = () => reject()
      document.head.appendChild(link)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><script src="https://cdn.jsdelivr.net/npm/echarts@5.4.1/dist/echarts.min.js"></script><link rel="stylesheet" href="/css/twikoo2.css"><link rel="stylesheet" href="/css/twikoo1.css"><link rel="stylesheet" href="/css/footer1.css"><link rel="apple-touch-icon" href="/img/favicon.jpeg"><meta name="apple-mobile-web-app-title" content="秋白's Blog"><link rel="bookmark" href="/img/favicon.jpeg"><link rel="apple-touch-icon-precomposed" sizes="180x180" href="/img/favicon.jpeg" ><link rel="stylesheet" href="/css/footer_bg.css"><link rel="stylesheet" href="/css/background.css"><link rel="stylesheet" href="/css/nav1.css"><meta name="baidu-site-verification" content="codeva-qQP2iZOMLX" /><meta name="generator" content="Hexo 6.3.0"></head><body><div id="web_bg"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="https://zyr-blog-image.oss-cn-beijing.aliyuncs.com/img/blog-img-main/favicon.png" onerror="onerror=null;src='https://zyr-blog-image.oss-cn-beijing.aliyuncs.com/img/blog-img-main/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">106</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">62</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">71</div></a></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 主页</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);" rel="external nofollow noreferrer"><i class="fa-fw fa-regular fa-folder-open"></i><span> 找文章</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></li><li><a class="site-page child" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间轴</span></a></li><li><a class="site-page child" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 链接</span></a></div><div class="menus_item"><a class="site-page" href="/comments/"><i class="fa-fw fa-solid fa-envelope-open-text"></i><span> 留言板</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('https://zyr-blog-image.oss-cn-beijing.aliyuncs.com/img102.jpg')"><nav id="nav"><span id="blog-info"><a href="/" title="秋白's Blog"><img class="site-icon" src="https://zyr-blog-image.oss-cn-beijing.aliyuncs.com/img/blog-img-main/favicon.png"/><span class="site-name">秋白's Blog</span></a></span><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 主页</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);" rel="external nofollow noreferrer"><i class="fa-fw fa-regular fa-folder-open"></i><span> 找文章</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></li><li><a class="site-page child" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间轴</span></a></li><li><a class="site-page child" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 链接</span></a></div><div class="menus_item"><a class="site-page" href="/comments/"><i class="fa-fw fa-solid fa-envelope-open-text"></i><span> 留言板</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div></div></div><div id="nav-right"><div id="search-button"><a class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> 搜索</span></a></div><div id="toggle-menu"><a class="site-page" href="javascript:void(0);" rel="external nofollow noreferrer"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">数论基础</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2024-02-18T05:25:58.000Z" title="发表于 2024-02-18 13:25:58">2024-02-18</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2024-02-19T05:31:29.955Z" title="更新于 2024-02-19 13:31:29">2024-02-19</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E5%92%8C%E7%AE%97%E6%B3%95/">数据结构和算法</a><i class="fas fa-angle-right post-meta-separator"></i><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E5%92%8C%E7%AE%97%E6%B3%95/%E7%AE%97%E6%B3%95%E9%A2%98/">算法题</a><i class="fas fa-angle-right post-meta-separator"></i><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E5%92%8C%E7%AE%97%E6%B3%95/%E7%AE%97%E6%B3%95%E9%A2%98/%E6%95%B0%E8%AE%BA/">数论</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">字数总计:</span><span class="word-count">14.9k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>63分钟</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="数论基础"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post" style="background: white; backdrop-filter: blur(5px); opacity: 0.98"><article class="post-content" id="article-container"><details>此笔记是我学习 ACwing算法基础课 的学习笔记。内容很多，请耐心学习，可以去网站上提交测试代码。</details>

<h1 id="数论"><a href="#数论" class="headerlink" title="数论"></a>数论</h1><h2 id="质数（素数）"><a href="#质数（素数）" class="headerlink" title="质数（素数）"></a>质数（素数）</h2><blockquote>
<p>  在大于1的整数中，如果只包含1和本身这两个约数，就被称为质数或素数</p>
</blockquote>
<h3 id="质数的判定——试除法"><a href="#质数的判定——试除法" class="headerlink" title="质数的判定——试除法"></a>质数的判定——试除法</h3><blockquote>
<p>  <strong>题目描述</strong></p>
</blockquote>
<p>给定n个正整数$a_i$，判定每个数是否是质数。</p>
<blockquote>
<p>  <strong>输入格式:</strong></p>
</blockquote>
<p>第一行包含整数n。</p>
<p>接下来n行，每行包含一个正整数$a_i$。</p>
<blockquote>
<p>  <strong>输出格式</strong></p>
</blockquote>
<p>共n行，其中第 i 行输出第 i 个正整数$a_i$是否为质数，是则输出“Yes”，否则输出“No”。</p>
<blockquote>
<p>  <strong>数据范围</strong></p>
</blockquote>
<p>$1≤n≤100$,<br>$1≤a_i≤2∗109$</p>
<blockquote>
<p>  <strong>输入样例：</strong></p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">2</span><br><span class="line">2</span><br><span class="line">6</span><br></pre></td></tr></table></figure>
<blockquote>
<p>  <strong>输出样例：</strong></p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Yes</span><br><span class="line">No</span><br></pre></td></tr></table></figure>
<blockquote>
<p>  <strong>实现代码:</strong></p>
</blockquote>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">bool</span> <span class="title">is_prime</span><span class="params">(<span class="type">int</span> n)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (n &lt; <span class="number">2</span>) <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">2</span>; i &lt; n; ++i) <span class="keyword">if</span> (n%i == <span class="number">0</span>) <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="type">int</span> n, t;</span><br><span class="line">    cin &gt;&gt; n;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; n; ++i) &#123;</span><br><span class="line">        cin &gt;&gt; t;</span><br><span class="line">        <span class="keyword">if</span> (<span class="built_in">is_prime</span>(t)) cout &lt;&lt; <span class="string">&quot;Yes\n&quot;</span>;</span><br><span class="line">        <span class="keyword">else</span> cout &lt;&lt; <span class="string">&quot;No\n&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>这时候的算法时间复杂度为$O(n)$。</p>
<p>但是有一个性质：$若d|n，则\frac{n}{d}|n$，例如$2|12，则6|12$，因此在判断12是否是质数时，只需要枚举一个数（2），即可，假设$d \leq \frac{n}{d}$,于是循环即可修改为：</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">2</span>; i &lt;= n/i; ++i) <span class="keyword">if</span> (n%i == <span class="number">0</span>) <span class="keyword">return</span> <span class="literal">false</span>;</span><br></pre></td></tr></table></figure>
<p>这时候的算法时间复杂度为$O(\sqrt n)$</p>
<h3 id="分解质因数——试除法"><a href="#分解质因数——试除法" class="headerlink" title="分解质因数——试除法"></a>分解质因数——试除法</h3><blockquote>
<p>  <strong>题目描述</strong></p>
</blockquote>
<p>给定n个整数$a_i$，将每个数分解质因数，并按照质因数从小到大的顺序输出每个质因数的底数和指数</p>
<blockquote>
<p>  <strong>输入格式</strong></p>
</blockquote>
<p>第一行包含整数n。</p>
<p>接下来n行，每行包含一个整数$a_i$</p>
<blockquote>
<p>  <strong>输出格式</strong></p>
</blockquote>
<p>对于每个正整数$a_i$，按照从小到大的顺序输出其分解质因数后，每个质因数的底数和指数，每个底数和指数占一行。</p>
<p>每个正整数的质因数全部输出完毕后，输出一个空行。</p>
<blockquote>
<p>  <strong>数据范围</strong></p>
</blockquote>
<p>$1 \leq n \leq 100$,</p>
<p>$1 \leq a_i \leq 2*10^9$</p>
<blockquote>
<p>  <strong>输入样例：</strong></p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">2</span><br><span class="line">6</span><br><span class="line">8</span><br></pre></td></tr></table></figure>
<blockquote>
<p>  <strong>输出样例：</strong></p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">2 1</span><br><span class="line">3 1</span><br><span class="line"></span><br><span class="line">2 3</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>说明：$6 = 2^1 * 3^1;8 = 2^3$</p>
<blockquote>
<p>  <strong>实现代码:</strong></p>
</blockquote>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">divide</span><span class="params">(<span class="type">int</span> n)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">2</span>; i &lt;= n; ++i)</span><br><span class="line">        <span class="keyword">if</span> (n%i == <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="type">int</span> s = <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">while</span> (n%i == <span class="number">0</span>) &#123;</span><br><span class="line">                n /= i;</span><br><span class="line">                s++;</span><br><span class="line">            &#125;</span><br><span class="line">            cout &lt;&lt; i &lt;&lt; <span class="string">&quot; &quot;</span> &lt;&lt; s &lt;&lt; endl;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (n &gt; <span class="number">1</span>) cout &lt;&lt; n &lt;&lt; <span class="string">&quot; 1\n&quot;</span>;</span><br><span class="line">    cout &lt;&lt; endl;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="type">int</span> n, t;</span><br><span class="line">    cin &gt;&gt; n;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; n; ++i) &#123;</span><br><span class="line">        cin &gt;&gt; t;</span><br><span class="line">        <span class="built_in">divide</span>(t);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>该方法依次判断每一个数是否能被模尽（<code>n%i == 0</code>），如果能，则就是答案</p>
<blockquote>
<p>  这里看起来好像是每一个数都在判断，看似包含了合数。但实际上我们知道，若$i|n \and j|i$则$j|n \and j&lt;i$。因此遇到的第一个可以模尽的数，它应该是没有约数的。即当<code>n%i == 0</code>成立时，i没有其他约数，因此i就是质数。</p>
</blockquote>
<p>优化：</p>
<p>根据性质：n中最多只包含一个大于$\sqrt{n}$的质因子。于是可以把循环条件改为：</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">2</span>; i &lt;= n/i; ++i)</span><br></pre></td></tr></table></figure>
<p>因此时间复杂度为：$O(\log n)到O(\sqrt{n})$</p>
<h3 id="筛质数"><a href="#筛质数" class="headerlink" title="筛质数"></a>筛质数</h3><p>其思想就是从2开始筛选（1一定不是质数），对于一个数，把它的所有在范围内的倍数筛选掉（因为它的倍数一定是非质数）。当遍历到一个数<code>x</code>时，如果它没有被筛选掉，则说明在2～x-1中没有它的约数（在x-1～N中更不可能有它的约数），因此它是质数，则添加到质数数组中。</p>
<blockquote>
<p>  <strong>题目描述</strong></p>
</blockquote>
<p>给定一个正整数n，请你求出1～n中质数的<strong>个数</strong></p>
<blockquote>
<p>  <strong>输入格式</strong></p>
</blockquote>
<p>共一行，包含整数n</p>
<blockquote>
<p>  <strong>数据范围</strong></p>
</blockquote>
<p>$1 \le n \le 10^6$</p>
<blockquote>
<p>  <strong>输入样例</strong></p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">8</span><br></pre></td></tr></table></figure>
<blockquote>
<p>  <strong>输出样例</strong></p>
</blockquote>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">4</span></span><br></pre></td></tr></table></figure>
<blockquote>
<p>  实现代码</p>
</blockquote>
<p>埃式筛法：</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N = <span class="number">1e6</span>+<span class="number">1</span>;</span><br><span class="line"><span class="type">int</span> primes[N], cnt; <span class="comment">// primes存质因数，cnt表示个数</span></span><br><span class="line"><span class="type">bool</span> st[N]; <span class="comment">// 表示是否筛掉</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">get_prime</span><span class="params">(<span class="type">int</span> n)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">2</span>; i &lt;= n; ++i) &#123;</span><br><span class="line">        <span class="keyword">if</span> (!st[i]) primes[cnt++] = i;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = i+<span class="number">1</span>; j &lt;= n; j+=i) st[j] = <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="type">int</span> n, t;</span><br><span class="line">    cin &gt;&gt; n;</span><br><span class="line">    <span class="built_in">get_prime</span>(n);</span><br><span class="line">    cout &lt;&lt; cnt &lt;&lt; endl;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>这种筛法就是直接根据上诉思想进行筛选，它的时间复杂度为$O(n\log n)$</p>
<p>线性筛法：</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">get_prime</span><span class="params">(<span class="type">int</span> n)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">2</span>; i &lt;= n; ++i) &#123;</span><br><span class="line">        <span class="keyword">if</span> (!st[i]) primes[cnt++] = i;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>; primes[j] &lt;= n/i; ++j) &#123;</span><br><span class="line">            st[primes[j] * i] = <span class="literal">true</span>;</span><br><span class="line">            <span class="keyword">if</span> (i%primes[j] == <span class="number">0</span>) <span class="keyword">break</span>; <span class="comment">// primes[j] 是i的最小质因子</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>这种筛法特点是只会被<strong>最小质因子</strong>筛掉，并且每个合数只会被筛掉一次。</p>
<p>原因是它不是无脑筛选i的每一个倍数（埃式筛对每个数i都会筛选其$1、2、3、\cdots、k$），而是筛选掉<code>primes[j]*i</code>，即已有质数倍，i不同则<code>primes[j]*i</code>一定不同。</p>
<p><code>if (i%primes[j] == 0) break;</code>当遇到了i的第一个质因数的时候，就停止筛选，避免重复筛选$primes[j]^2<em>i$(到后面这个数一定会被$primes[j]</em>i$筛选一次的)，同理，避免重复筛选$primes[j]^3<em>i、primes[j]^4</em>i、\cdots、primes[j]^k*i$。这样可以保证同一个合数不会被筛选两次。</p>
<blockquote>
<p>  直观一点：1 2 3 4 5 6 7 8 9 10 11 12</p>
<ul>
<li><p>当<code>i=2</code>时：</p>
<p>primes[] = [2]</p>
<p>筛选掉2*2=4</p>
</li>
<li><p>当<code>i=3</code>时：</p>
<p>primes[] = [2, 3]</p>
<p>筛选掉2*3=6,3*3=9</p>
</li>
<li><p>当<code>i=4</code>时：</p>
<p>primes[] = [2, 3]</p>
<p>筛选掉：2*4=8</p>
<p>然后<code>4%2==0</code>停止筛选</p>
</li>
<li><p>当<code>i=5</code>时：</p>
<p>primes[] = [2, 3, 5]</p>
<p>筛选掉：2*5=10(3 &gt; 12/5，因此3、5与5的倍数不用再筛选)</p>
</li>
<li><p>当<code>i=6</code>时：</p>
<p>primes[] = [2, 3, 5]</p>
<p>筛选掉：2*6=12</p>
<p>举例就到这里了，可以发现每一个数都只被筛选了一次。其中被筛选掉的12是比较特殊的，它的质因数为2、3，且有算数基本定理可以表达为$2^2*3^1$，因此12可以被4筛选一次，也可以被6筛选一次，所以为了避免麻烦，就让6筛选掉即可。</p>
</li>
</ul>
</blockquote>
<p><strong>这个方法更快</strong>。</p>
<h2 id="约数"><a href="#约数" class="headerlink" title="约数"></a>约数</h2><h3 id="试除法求约数"><a href="#试除法求约数" class="headerlink" title="试除法求约数"></a>试除法求约数</h3><blockquote>
<p>  <strong>题目描述</strong></p>
</blockquote>
<p>给定n个正整数$a_i$,对于每个整数$a_i$，请你按照从小到大的顺序输出它的所有约数。</p>
<blockquote>
<p>  <strong>输入格式</strong></p>
</blockquote>
<p>第一行包含整数n。</p>
<p>接下来n行，每行包含一个整数$a_i$。</p>
<blockquote>
<p>  <strong>输出格式</strong></p>
</blockquote>
<p>输出共n行，其中第i行输出第i个整数$a_i$的所有约数。</p>
<blockquote>
<p>  <strong>数据范围</strong></p>
</blockquote>
<p>$1 \le n \le 100$,</p>
<p>$2 \le a_i \le 2*10^9$</p>
<blockquote>
<p>  <strong>输入样例</strong></p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">2</span><br><span class="line">6</span><br><span class="line">8</span><br></pre></td></tr></table></figure>
<blockquote>
<p>  <strong>输出样例</strong></p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">1 2 3 6</span><br><span class="line">1 2 4 8</span><br></pre></td></tr></table></figure>
<blockquote>
<p>  <strong>实现代码</strong></p>
</blockquote>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;vector&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">get_divisors</span><span class="params">(<span class="type">int</span> n)</span> </span>&#123;</span><br><span class="line">    vector&lt;<span class="type">int</span>&gt; res;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n/i; ++i) &#123;</span><br><span class="line">        <span class="keyword">if</span> (n%i == <span class="number">0</span>) res.<span class="built_in">push_back</span>(i);</span><br><span class="line">        <span class="keyword">if</span> (i != n/i) res.<span class="built_in">push_back</span>(n/i);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">sort</span>(res.<span class="built_in">begin</span>(), res.<span class="built_in">end</span>());</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="type">int</span> n, t;</span><br><span class="line">    cin &gt;&gt; n;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; n; ++i) &#123;</span><br><span class="line">        cin &gt;&gt; t;</span><br><span class="line">        <span class="keyword">auto</span> res = <span class="built_in">get_divisors</span>(t);</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">auto</span> x: res) cout &lt;&lt; x &lt;&lt; <span class="string">&quot; &quot;</span>;</span><br><span class="line">        cout &lt;&lt; endl;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>时间复杂度为$O(\sqrt n)$</p>
<h3 id="约数个数"><a href="#约数个数" class="headerlink" title="约数个数"></a>约数个数</h3><h4 id="性质"><a href="#性质" class="headerlink" title="性质"></a>性质</h4><p>由算数基本定理：$N=p_1^{\alpha_1} + p_2^{\alpha_2} + \cdots + p_k^{\alpha_k}$，可以得出，<strong>约数个数</strong>为$(\alpha_1+1)(\alpha_2+1)\cdots(\alpha_k+1)$。</p>
<blockquote>
<p>  <strong>算术基本定理</strong>，又称为<strong><a target="_blank" rel="noopener external nofollow noreferrer" href="https://zh.wikipedia.org/wiki/正整數">正整数</a>的唯一分解定理</strong>，即：每个大于1的<a target="_blank" rel="noopener external nofollow noreferrer" href="https://zh.wikipedia.org/wiki/自然数">自然数</a>，要么本身就是<a target="_blank" rel="noopener external nofollow noreferrer" href="https://zh.wikipedia.org/wiki/质数">质数</a>，要么可以写为2个或以上的质数的<a target="_blank" rel="noopener external nofollow noreferrer" href="https://zh.wikipedia.org/wiki/积">积</a>，而且这些质因子按大小排列之后，写法仅有一种方式。</p>
<p>  例如：$6936=2^3×3×17^2，1200=2^4×3×5^2，5207=41×127$。</p>
<p>  <strong>题目描述</strong></p>
</blockquote>
<p>给定n个正整数$a_i$,请你输出这些数的乘积的约数个数，答案对$10^9+7$取模</p>
<blockquote>
<p>  <strong>输入格式</strong></p>
</blockquote>
<p>第一行包含整数n。</p>
<p>接下来n行，每行包含一个整数$a_i$。</p>
<blockquote>
<p>  <strong>输出格式</strong></p>
</blockquote>
<p>输出一个整数，表示所给正整数的乘积的约数个数，答案需对$10^9+7$取模。</p>
<blockquote>
<p>  <strong>数据范围</strong></p>
</blockquote>
<p>$1 \le n \le 100$,</p>
<p>$2 \le a_i \le 2*10^9$</p>
<blockquote>
<p>  <strong>输入样例</strong></p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">3</span><br><span class="line">2</span><br><span class="line">6</span><br><span class="line">8</span><br></pre></td></tr></table></figure>
<blockquote>
<p>  <strong>输出样例</strong></p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">12</span><br></pre></td></tr></table></figure>
<blockquote>
<p>  <strong>实现代码</strong></p>
</blockquote>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;unordered_map&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="type">long</span> <span class="type">long</span> ll;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> mod = <span class="number">1e9</span>+<span class="number">7</span>;</span><br><span class="line">unordered_map&lt;<span class="type">int</span>, <span class="type">int</span>&gt; primes;</span><br><span class="line">ll res = <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">divide</span><span class="params">(<span class="type">int</span> n)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">2</span>; i &lt;= n; ++i)</span><br><span class="line">        <span class="keyword">while</span> (n%i == <span class="number">0</span>) &#123;</span><br><span class="line">            n /= i;</span><br><span class="line">            primes[i] ++;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (n &gt; <span class="number">1</span>) primes[n] ++;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="type">int</span> n, t;</span><br><span class="line">    cin &gt;&gt; n;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; n; ++i) &#123;</span><br><span class="line">        cin &gt;&gt; t;</span><br><span class="line">        <span class="built_in">divide</span>(t);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">auto</span> prime: primes)</span><br><span class="line">        res = res*(prime.second+<span class="number">1</span>)%mod;</span><br><span class="line">    cout &lt;&lt; res &lt;&lt; endl;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>这个代码利用到了<a href="#分解质因数——试除法">分解质因数——试除法</a>的内容，来求底数$p_i$和指数$\alpha_i$（利用哈希表来存储）。然后利用性质，进行计算。</p>
<h3 id="约数之和"><a href="#约数之和" class="headerlink" title="约数之和"></a>约数之和</h3><h4 id="性质-1"><a href="#性质-1" class="headerlink" title="性质"></a>性质</h4><p>由算数基本定理：$N=p_1^{\alpha_1} + p_2^{\alpha_2} + \cdots + p_k^{\alpha_k}$，可以得出，<strong>约数之和</strong>为$(p_1^0+p_1^1+\cdots+p_1^{\alpha_1})\cdots(p_k^0+p_k^1+\cdots+p_k^{\alpha_k})$</p>
<blockquote>
<p>  <strong>题目描述</strong></p>
</blockquote>
<p>给定n个正整数$a_i$,请你输出这些数的乘积的约数之和，答案对$10^9+7$取模</p>
<blockquote>
<p>  <strong>输入格式</strong></p>
</blockquote>
<p>第一行包含整数n。</p>
<p>接下来n行，每行包含一个整数$a_i$。</p>
<blockquote>
<p>  <strong>输出格式</strong></p>
</blockquote>
<p>输出一个整数，表示所给正整数的乘积的约数之和，答案需对$10^9+7$取模。</p>
<blockquote>
<p>  <strong>数据范围</strong></p>
</blockquote>
<p>$1 \le n \le 100$,</p>
<p>$2 \le a_i \le 2*10^9$</p>
<blockquote>
<p>  <strong>输入样例</strong></p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">3</span><br><span class="line">2</span><br><span class="line">6</span><br><span class="line">8</span><br></pre></td></tr></table></figure>
<blockquote>
<p>  <strong>输出样例</strong></p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">252</span><br></pre></td></tr></table></figure>
<blockquote>
<p>  <strong>实现代码</strong></p>
</blockquote>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;unordered_map&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="type">long</span> <span class="type">long</span> ll;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> mod = <span class="number">1e9</span>+<span class="number">7</span>;</span><br><span class="line">unordered_map&lt;<span class="type">int</span>, <span class="type">int</span>&gt; primes;</span><br><span class="line">ll res = <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">divide</span><span class="params">(<span class="type">int</span> n)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">2</span>; i &lt;= n; ++i)</span><br><span class="line">        <span class="keyword">while</span> (n%i == <span class="number">0</span>) &#123;</span><br><span class="line">            n /= i;</span><br><span class="line">            primes[i] ++;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (n &gt; <span class="number">1</span>) primes[n] ++;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="type">int</span> n, t;</span><br><span class="line">    cin &gt;&gt; n;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; n; ++i) &#123;</span><br><span class="line">        cin &gt;&gt; t;</span><br><span class="line">        <span class="built_in">divide</span>(t);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">auto</span> prime: primes) &#123;</span><br><span class="line">        <span class="type">int</span> p = prime.first, a = prime.second;</span><br><span class="line">        ll tp = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">while</span> (a--) tp = (tp*p+<span class="number">1</span>)%mod;</span><br><span class="line">        res = res * tp %mod;</span><br><span class="line">    &#125;</span><br><span class="line">    cout &lt;&lt; res &lt;&lt; endl;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>这个代码利用到了<a href="#分解质因数——试除法">分解质因数——试除法</a>的内容，来求底数$p_i$和指数$\alpha_i$（利用哈希表来存储）。然后利用性质，进行计算。</p>
<h3 id="最大公约数-欧几里得算法、辗转相除法"><a href="#最大公约数-欧几里得算法、辗转相除法" class="headerlink" title="最大公约数(欧几里得算法、辗转相除法)"></a>最大公约数(欧几里得算法、辗转相除法)</h3><blockquote>
<p>  <strong>题目描述</strong></p>
</blockquote>
<p>给定n对正整数$a_i,b_i$,请你求出每对数的最大公约数。</p>
<blockquote>
<p>  <strong>输入格式</strong></p>
</blockquote>
<p>第一行包含整数n。</p>
<p>接下来n行，每行包含一个整数对$a_i,b_i$。</p>
<blockquote>
<p>  <strong>输出格式</strong></p>
</blockquote>
<p>输出共n行，每行输出一个整数对的最大公约数。</p>
<blockquote>
<p>  <strong>数据范围</strong></p>
</blockquote>
<p>$1 \le n \le 10^5$,</p>
<p>$1 \le a_i,b_i \le 2*10^9$</p>
<blockquote>
<p>  <strong>输入样例</strong></p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">2</span><br><span class="line">3 6</span><br><span class="line">4 6</span><br></pre></td></tr></table></figure>
<blockquote>
<p>  <strong>输出样例</strong></p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">3</span><br><span class="line">2</span><br></pre></td></tr></table></figure>
<blockquote>
<p>  <strong>实现代码</strong></p>
</blockquote>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">gcd</span><span class="params">(<span class="type">int</span> a, <span class="type">int</span> b)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> b ? <span class="built_in">gcd</span>(b, a%b) : a;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="type">int</span> n, a, b;</span><br><span class="line">    cin &gt;&gt; n;</span><br><span class="line">    <span class="keyword">while</span> (n--) &#123;</span><br><span class="line">        cin &gt;&gt; a &gt;&gt; b;</span><br><span class="line">        cout &lt;&lt; <span class="built_in">gcd</span>(a, b) &lt;&lt; endl;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>时间复杂度为$O(\log n)$</p>
<h2 id="欧拉函数"><a href="#欧拉函数" class="headerlink" title="欧拉函数"></a>欧拉函数</h2><p>1～N中<strong>与N互质的个数</strong>被称为欧拉函数，记为$\varPhi(N)$。</p>
<p>若在算数基本定理中，$N=p_1^{\alpha_1}p_2^{\alpha_2}\cdots p_m^{\alpha_m}$,则：</p>
<p>$\varPhi(N) = N<em>\frac{p_1-1}{p_1}</em>\frac{p_2-1}{p_2}<em>\cdots</em>\frac{p_m-1}{p_m} = N<em>(1-\frac{1}{p_1})</em>(1-\frac{1}{p_2})<em>\cdots </em>(1-\frac{1}{p_m})$$，\varPhi(1) = 1$</p>
<blockquote>
<p>  例如：</p>
<p>  $1,2,3,4,5,6$,其中，只有1，5与6互质，因此：</p>
<p>  $\varPhi(6) = 2$​​​</p>
<p>  用算数基本定理计算：$6=2^1<em>3^1$，$\varPhi(6) = 6</em>\frac{2-1}{2}<em>\frac{3-1}{3} = 6</em>\frac{1}{2}*\frac{2}{3} = 2$</p>
<hr>
<p>  <strong>互质</strong>：若N个整数的<a target="_blank" rel="noopener external nofollow noreferrer" href="https://baike.baidu.com/item/最大公因数/869104?fromModule=lemma_inlink">最大公因数</a>是1，则称这N个整数互质（$N \ge 2$​）。</p>
</blockquote>
<p>推导（根据容斥定理）：</p>
<ol>
<li>从 1～N 中去掉$p_1,p_2,\cdots,p_k$的所有倍数</li>
<li>加上所有$p_i*p_j$的倍数（加上交集）</li>
<li>减去所有$p_i<em>p_j</em>p_k$的倍数（多加了，又要再减一次交集）</li>
<li>加上所有$p_i<em>p_j</em>p_k$的倍数（上一步减交集后，因为多加了三次交集，又减去了三次交集，因此还需要加上一次），减去所有$p_i<em>p_j</em>p_k*p_l$的倍数（因为又会有交集）</li>
<li>以次类推，就得到了上述式子</li>
</ol>
<blockquote>
<p>  容斥定理：</p>
<p>  以三个集合举例：</p>
<p>  <img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://pic2.zhimg.com/80/v2-cffcfe0291304d3f5b8548876c1dffd1_1440w.png" alt="容斥定理"></p>
<p>  就是要求元素个数，就是$A \cup B \cup C - A\cap B - B\cap C-A \cap C + A \cap B\cap C$​</p>
<p>  如果推广到K个集合，就是上诉式子了。</p>
</blockquote>
<h3 id="欧拉函数-1"><a href="#欧拉函数-1" class="headerlink" title="欧拉函数"></a>欧拉函数</h3><blockquote>
<p>  <strong>题目描述</strong></p>
</blockquote>
<p>给定n个正整数$a_i$,请你求出每个数的欧拉函数。</p>
<blockquote>
<p>  <strong>输入格式</strong></p>
</blockquote>
<p>第一行包含整数n。</p>
<p>接下来n行，每行包含一个正整数$a_i$。</p>
<blockquote>
<p>  <strong>输出格式</strong></p>
</blockquote>
<p>输出共n行，每行输出一个正整数$a_i$的欧拉函数。</p>
<blockquote>
<p>  <strong>数据范围</strong></p>
</blockquote>
<p>$1 \le n \le 100$,</p>
<p>$1 \le a_i,b_i \le 2*10^9$</p>
<blockquote>
<p>  <strong>输入样例</strong></p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">3</span><br><span class="line">3</span><br><span class="line">6</span><br><span class="line">8</span><br></pre></td></tr></table></figure>
<blockquote>
<p>  <strong>输出样例</strong></p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">2</span><br><span class="line">2</span><br><span class="line">4</span><br></pre></td></tr></table></figure>
<blockquote>
<p>  <strong>实现代码</strong></p>
</blockquote>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="type">int</span> n;</span><br><span class="line">    cin &gt;&gt; n;</span><br><span class="line">    <span class="keyword">while</span> (n--) &#123;</span><br><span class="line">        <span class="type">int</span> x;</span><br><span class="line">        cin &gt;&gt; x;</span><br><span class="line"></span><br><span class="line">        <span class="type">int</span> res = x;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">2</span>; i &lt;= x/i; ++i) &#123;</span><br><span class="line">            <span class="keyword">if</span> (x%i == <span class="number">0</span>) &#123;</span><br><span class="line">                res = res / i * (i<span class="number">-1</span>);</span><br><span class="line">                <span class="keyword">while</span> (x%i == <span class="number">0</span>) x /= i;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (x &gt; <span class="number">1</span>) res = res / x * (x<span class="number">-1</span>);</span><br><span class="line"></span><br><span class="line">        cout &lt;&lt; res &lt;&lt; endl;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>就是根据定义公式实现代码即可。时间复杂度是$O(\sqrt n)$,主要是在分解质因数上。</p>
<h3 id="筛法求欧拉函数"><a href="#筛法求欧拉函数" class="headerlink" title="筛法求欧拉函数"></a>筛法求欧拉函数</h3><blockquote>
<p>  <strong>题目描述</strong></p>
</blockquote>
<p>给定一个正整数n,求1～n中每个数的欧拉函数之和。</p>
<blockquote>
<p>  <strong>输入格式</strong></p>
</blockquote>
<p>输入一行，包含整数n。</p>
<blockquote>
<p>  <strong>输出格式</strong></p>
</blockquote>
<p>共一行，包含一个整数，表示1～n中每个数的欧拉函数之和。</p>
<blockquote>
<p>  <strong>数据范围</strong></p>
</blockquote>
<p>$1 \le n \le 10^6$</p>
<blockquote>
<p>  <strong>输入样例</strong></p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">6</span><br></pre></td></tr></table></figure>
<blockquote>
<p>  <strong>输出样例</strong></p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">12</span><br></pre></td></tr></table></figure>
<blockquote>
<p>  <strong>实现代码</strong></p>
</blockquote>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="type">long</span> <span class="type">long</span> ll;</span><br><span class="line"></span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N = <span class="number">1e6</span>+<span class="number">10</span>;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> primes[N], cnt;</span><br><span class="line"><span class="type">int</span> phi[N];</span><br><span class="line"><span class="type">bool</span> st[N];</span><br><span class="line"></span><br><span class="line"><span class="function">ll <span class="title">get_eulers</span><span class="params">(<span class="type">int</span> n)</span> </span>&#123;</span><br><span class="line">    ll res = <span class="number">0</span>;</span><br><span class="line">    phi[<span class="number">1</span>] = <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">2</span>; i &lt;= n; ++i) &#123;</span><br><span class="line">        <span class="keyword">if</span> (!st[i]) &#123;</span><br><span class="line">            primes[cnt++]  = i;</span><br><span class="line">            phi[i] = i<span class="number">-1</span>; <span class="comment">// 如果一个数为质数，那么它与前面的数均互质，因此它的欧拉函数为自身减一</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>; primes[j] &lt;= n/i; ++j) &#123;</span><br><span class="line">            st[primes[j] * i] = <span class="literal">true</span>;</span><br><span class="line">            <span class="keyword">if</span> (i%primes[j] == <span class="number">0</span>) &#123;</span><br><span class="line">                phi[primes[j]*i] = phi[i] * primes[j];</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            phi[primes[j]*i] = phi[i] * (primes[j]<span class="number">-1</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; ++i) res += phi[i];</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="type">int</span> n;</span><br><span class="line">    cin &gt;&gt; n;</span><br><span class="line"></span><br><span class="line">    cout &lt;&lt; <span class="built_in">get_eulers</span>(n) &lt;&lt; endl;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>其实就是在<a href="#筛质数">筛质数</a>的代码基础上进行改动。因为在遍历到一个质数时，这个质数的欧拉函数就是自身减一，即质数的欧拉函数是确定的。</p>
<p>之后再更新<code>i*primes[j]</code>的欧拉函数（这样是求非质数的欧拉函数），此时有两种情况：</p>
<ol>
<li><p><code>primes[j]</code>是<code>i</code>的质因数</p>
<p>由欧拉函数定义，必有：</p>
<p>$\varPhi(i)=i<em>(1-\frac{1}{p_1})</em>\cdots<em>(1-\frac{1}{p_j})</em>\cdots$。其中$p_j$为<code>primes[j]</code>.</p>
<p>若<code>i</code>可以用基本算数定理表达为:$p_1^{\alpha_1}p_2^{\alpha_2}<em>\cdots</em>p_j^{\alpha_j}*\cdots$</p>
<p>则<code>primes[j]*i</code>可表达为$p_1^{\alpha_1}p_2^{\alpha_2}<em>\cdots</em>p_j^{\alpha_j+1}*\cdots$​</p>
<p>由欧拉函数定义可知，欧拉函数只与底数有关，与指数无关，因此$\varPhi(i)$和$\varPhi(pj<em>i)$有相同的部分：$(1-\frac{1}{p_1})</em>\cdots<em>(1-\frac{1}{p_j})</em>\cdots$​</p>
<p>因此:$\varPhi(p_j<em>i) = (p_j</em>i)<em>(1-\frac{1}{p_1})</em>\cdots<em>(1-\frac{1}{p_j})</em>\cdots = p_j<em>[i</em>(1-\frac{1}{p_1})<em>\cdots</em>(1-\frac{1}{p_j})<em>\cdots] = p_j</em>\varPhi(i)$</p>
</li>
<li><p><code>primes[j]</code>不是<code>i</code>的质因数</p>
<p>由欧拉函数定义，必有：</p>
<p>$\varPhi(i)=i<em>(1-\frac{1}{p_1})</em>\cdots*(1-\frac{1}{p_k})$。其中一定不包含$p_j$.</p>
<p>若<code>i</code>可以用基本算数定理表达为:$p_1^{\alpha_1}p_2^{\alpha_2}<em>\cdots</em>p_k^{\alpha_k}$，注意，因为pj不是i的质因数，因此一定不包含底数为<code>primes[j]</code>的项</p>
<p>则<code>primes[j]*i</code>可表达为$p_1^{\alpha_1}p_2^{\alpha_2}<em>\cdots</em>p_k^{\alpha_k}*p_j^{\alpha_j}$</p>
<p>可以发现<code>primes[j]*i</code>相比于<code>i</code>只多了一个质因数（<code>primes[j]</code>）。因此由欧拉函数定义：$\varPhi(p_j<em>i)=(p_j</em>i)<em>(1-\frac{1}{p_1})</em>\cdots<em>(1-\frac{1}{p_k})</em>(1-\frac{1}{p_j})=p_j<em>\varPhi(i)</em>(1-\frac{1}{p_j})=\varPhi(i)*(p_j-1)$</p>
</li>
</ol>
<h3 id="求欧拉函数作用"><a href="#求欧拉函数作用" class="headerlink" title="求欧拉函数作用"></a>求欧拉函数作用</h3><p>欧拉定理：若$a$与$n$互质，则$a^{\varPhi(n)} \mod n = 1$</p>
<blockquote>
<p>  举例：</p>
<p>  a=5，n=6。5和6互质（满足条件）。$\varPhi(6)=2$</p>
<p>  $5^2=25，25 \mod 6 = 1$</p>
</blockquote>
<h2 id="快速幂"><a href="#快速幂" class="headerlink" title="快速幂"></a>快速幂</h2><p>用$O(\log k)$的时间复杂度，快速求出$a^k \mod p$。</p>
<p>如果用传统暴力做法：</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> res = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= k; ++i) res *= a%p;</span><br></pre></td></tr></table></figure>
<p>这样的时间复杂度为$O(k)$</p>
<p>快速幂算法的核心思想就是：重复利用$x^y \mod p$，其中$y$为$2^0、2^1、\cdots、2^{\log k}$</p>
<p>例如：$2^6=64$，如果暴力来做，就是6个2相乘；用快速幂就可以重复利用$2^{2^1}=4$​，即3个4相乘（4由2个2相乘），即最终进行了5次乘法晕眩，少了一次（数量大的时候少的次数更多）</p>
<p>原理其实就是把k拆分由$2^0、2^1、\cdots、2^{\log k}$​中的若干个数相加。即把k用二进制表示，哪些位是1，就加上2的这么多次方。</p>
<blockquote>
<p>  举例：$4^5 \mod 10$</p>
<ol>
<li><p>先预处理出$x^y \mod p，其中y=2^0、2^1、\cdots、2^{\log k}$​</p>
<p>这里的$\log k$其实就是$\sqrt k$，因此就是$\sqrt 5 \approx 2$​</p>
<p>$4^{2^0} \mod 10 = 4^1 \mod 10 = 4$</p>
<p>$4^{2^1} \mod 10 = (4^{2^0} \mod 10)^2 \mod 10=16 \mod 10 =6$</p>
<p>$4^{2^2} \mod 10 = (4^{2^1} \mod 10)^2 \mod 10 = 36 \mod 10 = 6$</p>
</li>
<li><p>再根据表示进行相乘</p>
<p>5的二进制表示为101，即由$2^0+2^2$组成，$4^{2^0} \mod 10$和$4^{2^2} \mod 10$的值可查上一步表</p>
<p>所以$4^5 \mod 10=4^{2^0}<em>4^{2^2} \mod 10=4</em>6\mod 10 = 4$</p>
</li>
</ol>
</blockquote>
<h3 id="快速幂-1"><a href="#快速幂-1" class="headerlink" title="快速幂"></a>快速幂</h3><blockquote>
<p>  <strong>题目描述</strong></p>
</blockquote>
<p>给定n组$a_i,b_i,p_i$，对于每组数据，求出$a_i^{b_i} \mod p_i$的值。</p>
<blockquote>
<p>  <strong>输入格式</strong></p>
</blockquote>
<p>第一行包含整数n。</p>
<p>接下来n行，每行包含三个整数$a_i,b_i,p_i$</p>
<blockquote>
<p>  <strong>输出格式</strong></p>
</blockquote>
<p>对于每组数据，输出一个结果，表示$a_i^{b_i} \mod p_i$的值。</p>
<p>每个结果占一行。</p>
<blockquote>
<p>  <strong>数据范围</strong></p>
</blockquote>
<p>$1 \le n \le 10^6$​,</p>
<p>$1 \le a_i, b_i, p_i \le2*10^9$</p>
<blockquote>
<p>  <strong>输入样例</strong></p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">2</span><br><span class="line">3 2 5</span><br><span class="line">4 3 9</span><br></pre></td></tr></table></figure>
<blockquote>
<p>  <strong>输出样例</strong></p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">4</span><br><span class="line">1</span><br></pre></td></tr></table></figure>
<blockquote>
<p>  <strong>实现代码</strong></p>
</blockquote>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="type">long</span> <span class="type">long</span> ll;</span><br><span class="line"></span><br><span class="line"><span class="function">ll <span class="title">qmi</span><span class="params">(<span class="type">int</span> a, <span class="type">int</span> k, <span class="type">int</span> p)</span> </span>&#123;</span><br><span class="line">    ll res = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span> (k) &#123;</span><br><span class="line">        <span class="keyword">if</span> (k&amp;<span class="number">1</span>) res = res * a % p;</span><br><span class="line">        k &gt;&gt;= <span class="number">1</span>;</span><br><span class="line">        a = a * a % p;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="type">int</span> n;</span><br><span class="line">    cin &gt;&gt; n;</span><br><span class="line">    <span class="keyword">while</span> (n--) &#123;</span><br><span class="line">        <span class="type">int</span> a, k, p;</span><br><span class="line">        cin &gt;&gt; a &gt;&gt; k &gt;&gt; p;</span><br><span class="line">        cout &lt;&lt; <span class="built_in">qmi</span>(a, k, p) &lt;&lt; endl;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>其实这个代码看起来就只是求k的二进制表达。</p>
<p>每一次循环都有<code>a*a%p</code>，即每一次循环结束后，a都变为了$a^2$。第一次循环中的$a=a^{2^0}$；第一次循环结束后，第二次循环中$a=a^{2^1}$；第二次循环结束后，第三次循环中的$a=(a^2)^2=a^{2^2}$，即第i次中的$a=a^{2^{i-1}}$。</p>
<p>每次循环都会判断k的末位，然后判断结束后将k右移一位，相当于第i次循环就是判断k的第i-1位（二进制的数法一般都是从右往左数，且实际的第一位为$2^0$），如果k的第i-1位为1了，可以直接使用a，此时的a表示的就是预处理后的$a^{2^{i-1}}$</p>
<h3 id="快速幂求逆元"><a href="#快速幂求逆元" class="headerlink" title="快速幂求逆元"></a>快速幂求逆元</h3><blockquote>
<p>  <strong>题目描述</strong></p>
</blockquote>
<p>给定n组$a_i,p_i$，其中$p_i$是质数，求出$a_i \mod p_i$的乘法逆元，若逆元不存在则输出impossible。</p>
<p>乘法逆元定义：</p>
<ul>
<li>若整数$b,m$互质，并且$b|a$，则存在一个整数$x$，使得$a/b \mod m=a*x \mod m$，则称$x$为$b$的模$m$乘法逆元，记为$b^{-1}(mod\ m)$。</li>
<li>$b$存在乘法逆元的充要条件是$b$与模数$m$互质。当模数$m$为质数时，$b^{m-2}$即为b的乘法逆元。</li>
</ul>
<blockquote>
<p>  <strong>输入格式</strong></p>
</blockquote>
<p>第一行包含整数n。</p>
<p>接下来n行，每行包含两个整数$a_i,p_i$，数据保证$p_i$是质数。</p>
<blockquote>
<p>  <strong>输出格式</strong></p>
</blockquote>
<p>共输出n行，每组数据输出一个结果，每个结果占一行。</p>
<p>若$a_i$模$p_i$的乘法逆元存在，则输出一个整数，表示逆元，否则输出impossible。</p>
<blockquote>
<p>  <strong>数据范围</strong></p>
</blockquote>
<p>$1 \le n \le 10^5$​,</p>
<p>$1 \le a_i, p_i \le2*10^9$</p>
<blockquote>
<p>  <strong>输入样例</strong></p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">3</span><br><span class="line">4 3</span><br><span class="line">8 5</span><br><span class="line">6 3</span><br></pre></td></tr></table></figure>
<blockquote>
<p>  <strong>输出样例</strong></p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">impossible</span><br></pre></td></tr></table></figure>
<blockquote>
<p>  <strong>实现代码</strong></p>
</blockquote>
<p>其实从题目中的表述可以看出，给出$a_i和p_i$，求$a_i^{p_i-2} \mod p_i$。于是写出如下代码：</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="type">long</span> <span class="type">long</span> ll;</span><br><span class="line"></span><br><span class="line"><span class="function">ll <span class="title">qmi</span><span class="params">(<span class="type">int</span> a, <span class="type">int</span> k, <span class="type">int</span> p)</span> </span>&#123;</span><br><span class="line">    ll res = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span> (k) &#123;</span><br><span class="line">        <span class="keyword">if</span> (k&amp;<span class="number">1</span>) res = res * a % p;</span><br><span class="line">        k &gt;&gt;= <span class="number">1</span>;</span><br><span class="line">        a = a * a % p;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="type">int</span> n;</span><br><span class="line">    cin &gt;&gt; n;</span><br><span class="line">    <span class="keyword">while</span> (n--) &#123;</span><br><span class="line">        <span class="type">int</span> a, p;</span><br><span class="line">        cin &gt;&gt; a &gt;&gt; p;</span><br><span class="line">        ll res = <span class="built_in">qmi</span>(a, p<span class="number">-2</span>, p);</span><br><span class="line">        <span class="keyword">if</span> (a % p) cout &lt;&lt; res &lt;&lt; endl;</span><br><span class="line">        <span class="keyword">else</span> cout &lt;&lt; <span class="string">&quot;impossible\n&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>主要就是改了调用函数的地方。还有就是探讨什么时候无逆元（其实就是在<code>a%p==0</code>时无逆元）</p>
<h2 id="扩展欧几里得算法"><a href="#扩展欧几里得算法" class="headerlink" title="扩展欧几里得算法"></a>扩展欧几里得算法</h2><p><strong>「裴蜀定理」</strong></p>
<p>任意一对正整数$a,b$，那么一定存在非零整数$x,y$使得$ax+by=gcd(a, b)$​</p>
<blockquote>
<p>  <strong>证明：</strong></p>
</blockquote>
<p>设$gcd(a, b) = d,a=k<em>d,b=m</em>d$</p>
<p>因此$ax+by=kxd+myd=(kx+my)*d$，即$ax+by$一定是$a,b$的最小公约数的倍数</p>
<p>接下来就是找一对系数，来满足这样的条件，就需要使用扩展欧几里得算法了。</p>
<h3 id="扩展欧几里得算法-1"><a href="#扩展欧几里得算法-1" class="headerlink" title="扩展欧几里得算法"></a>扩展欧几里得算法</h3><blockquote>
<p>  <strong>题目描述</strong></p>
</blockquote>
<p>给定n对正整数$a_i,b_i$，对于每对数，求出一组$x_i,y_i$，使其满足$a_i<em>x_i+b_i</em>y_i=gcd(a_i， b_i)$。</p>
<blockquote>
<p>  <strong>输入格式</strong></p>
</blockquote>
<p>第一行包含整数n。</p>
<p>接下来n行，每行包含两个整数$a_i,b_i$</p>
<blockquote>
<p>  <strong>输出格式</strong></p>
</blockquote>
<p>共输出n行，对于每组数据，求出一组满足条件的$x_i,y_i$。每个结果占一行。</p>
<p>本题答案不唯一，输出任意满足条件的$x_i,y_i$均可</p>
<blockquote>
<p>  <strong>数据范围</strong></p>
</blockquote>
<p>$1 \le n \le 10^5$​,</p>
<p>$1 \le a_i, b_i \le2*10^9$</p>
<blockquote>
<p>  <strong>输入样例</strong></p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">2</span><br><span class="line">4 6</span><br><span class="line">8 18</span><br></pre></td></tr></table></figure>
<blockquote>
<p>  <strong>输出样例</strong></p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">-1 1</span><br><span class="line">-2 1</span><br></pre></td></tr></table></figure>
<blockquote>
<p>  <strong>实现代码</strong></p>
</blockquote>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">exgcd</span><span class="params">(<span class="type">int</span> a, <span class="type">int</span> b,<span class="type">int</span>&amp; x, <span class="type">int</span>&amp; y)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (!b) &#123;</span><br><span class="line">        x= <span class="number">1</span>, y = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">return</span> a;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="type">int</span> d = <span class="built_in">exgcd</span>(b, a%b, y, x);</span><br><span class="line">    y -= a/b*x;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> d;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="type">int</span> n;</span><br><span class="line">    cin &gt;&gt; n;</span><br><span class="line">    <span class="keyword">while</span> (n--) &#123;</span><br><span class="line">        <span class="type">int</span> a, b, x, y;</span><br><span class="line">        cin &gt;&gt; a &gt;&gt; b;</span><br><span class="line"></span><br><span class="line">        <span class="built_in">exgcd</span>(a, b, x, y);</span><br><span class="line"></span><br><span class="line">        cout &lt;&lt; x &lt;&lt; <span class="string">&quot; &quot;</span> &lt;&lt; y &lt;&lt; endl;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>「欧几里得算法」</strong>：</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">int</span> <span class="title">gcd</span><span class="params">(<span class="type">int</span> a, <span class="type">int</span> b)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> b ? <span class="built_in">gcd</span>(b, a%b) : a;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>其中证明过了，$gcd(a, b) = gcd(b, a\;mod\ b)$​​</p>
<p>因此拆开写后，递归函数就有两种情况：</p>
<ol>
<li><p><code>b==0</code></p>
<p>此时$gcd(a,b)=a$</p>
<p>当且仅当$x=1,y=0$时，$ax+by=a$​</p>
</li>
<li><p><code>b!=0</code></p>
<p><code>int d= exgce(b, a%b, y, x)</code>此时递归函数结束时，一定存在$by+(a\;mod\ b)x=gcd(a, b) = d$​</p>
<p>$\because a\;mod\ b = a-\lfloor\frac{a}{b}\rfloor*b$​</p>
<p>$\therefore by+(a-\lfloor\frac{a}{b}\rfloor*b)x=d$​</p>
<p>$\therefore ax+b(y-\lfloor\frac{a}{b}\rfloor x) = d$​</p>
<p>所以此时$x$的值不修改，$y-=\lfloor\frac{a}{b}\rfloor x$</p>
</li>
</ol>
<h3 id="线性同余方程"><a href="#线性同余方程" class="headerlink" title="线性同余方程"></a>线性同余方程</h3><blockquote>
<p>  <strong>题目描述</strong></p>
</blockquote>
<p>给定n对正整数$a_i,b_i,m_i$，对于每组数求出一个$x_i$，使其满足$a_i*x_i\equiv b_i(mod\ m_i)$，如果无解则输出impossible。</p>
<blockquote>
<p>  <strong>输入格式</strong></p>
</blockquote>
<p>第一行包含整数n。</p>
<p>接下来n行，每行包含一组数据$a_i,b_i,m_i$</p>
<blockquote>
<p>  <strong>输出格式</strong></p>
</blockquote>
<p>共输出n行，每组数据输出一个整数表示一个满足条件的$x_i$，如果无解则输出impossible。</p>
<p>每组数据结果占一行，结果可能不唯一，输出任意一个满足条件的结果均可。</p>
<p>输出答案必须在int范围之内。</p>
<blockquote>
<p>  <strong>数据范围</strong></p>
</blockquote>
<p>$1 \le n \le 10^5$​,</p>
<p>$1 \le a_i, b_i, m_i \le2*10^9$</p>
<blockquote>
<p>  <strong>输入样例</strong></p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">2</span><br><span class="line">2 3 6</span><br><span class="line">4 3 5</span><br></pre></td></tr></table></figure>
<blockquote>
<p>  <strong>输出样例</strong></p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">impossible</span><br><span class="line">-3</span><br></pre></td></tr></table></figure>
<blockquote>
<p>  <strong>实现代码</strong></p>
</blockquote>
<p>$ax \equiv b(mod\ m) \Leftrightarrow (\exists y \in Z) s.t. ax = my+b$​</p>
<p>即：$ax-my=b$,令$y’=-y$，则$ax+my’=b$，这就是扩展欧几里得。</p>
<p>因此有解的充分必要条件为$gcd(a, m) \mid b$​​</p>
<p>如果直接用<code>exgcd(a, m, x, y)</code>，求出的<code>x</code>满足$ax+my=gcd(a, m)$，但是b不一定等于$gcd(a,m)$，但是有解（即$b=k*gcd(a, m)$）。因此$akx+mky=d$,$x’=kx=\frac{b}{gcd(a,m)}x$.</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">exgcd</span><span class="params">(<span class="type">int</span> a, <span class="type">int</span> b,<span class="type">int</span>&amp; x, <span class="type">int</span>&amp; y)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (!b) &#123;</span><br><span class="line">        x= <span class="number">1</span>, y = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">return</span> a;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="type">int</span> d = <span class="built_in">exgcd</span>(b, a%b, y, x);</span><br><span class="line">    y -= a/b*x;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> d;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="type">int</span> n;</span><br><span class="line">    cin &gt;&gt; n;</span><br><span class="line">    <span class="keyword">while</span> (n--) &#123;</span><br><span class="line">        <span class="type">int</span> a, b, m, x, y;</span><br><span class="line">        cin &gt;&gt; a &gt;&gt; b &gt;&gt; m;</span><br><span class="line"></span><br><span class="line">        <span class="type">int</span> d = <span class="built_in">exgcd</span>(a, m, x, y);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (b % d) cout &lt;&lt; <span class="string">&quot;impossible\n&quot;</span>;</span><br><span class="line">        <span class="keyword">else</span> cout &lt;&lt; (<span class="type">long</span> <span class="type">long</span>)x*(b/d)%m &lt;&lt; endl; </span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="中国剩余定理"><a href="#中国剩余定理" class="headerlink" title="中国剩余定理"></a>中国剩余定理</h2><p> <strong>中国剩余定理</strong>，也叫<strong>孙子定理</strong>，之所以叫这个名字，是因为《孙子算经》中有这样一个问题：</p>
<blockquote>
<p>  有物不知其数，三三数之剩二，五五数之剩三，七七数之剩二。问物几何？</p>
</blockquote>
<p>这个被叫做“物不知数”的问题本质上是解下面的<strong>同余方程组</strong>：</p>
<p>后来的数学家在研究中发现，这一方程组有解的一个充分条件是 <strong>两两互质</strong>，并用<strong>构造法</strong>给出了这种情况下方程的通解。</p>
<p>即：</p>
<p>$m_1,m_2,\cdots,m_k$两两互质，对于方程组：</p>
<p>$\begin{cases} x \equiv a_1(mod\ m_1) \ x \equiv a_2(mod\ m_2) \ \qquad\quad \vdots \ x \equiv a_k(mod\ m_k) \end{cases}$​</p>
<p>令$M=m_1<em>m_2</em>\cdots*m_k$，$M_i=\frac{M}{m_i}$，$M_i^{-1}$表示$M_i$模$m_i$的逆。</p>
<p>方程组的通解为：$x=a_1<em>M_1</em>M_1^{-1} + a_2<em>M_2</em>M_2^{-1} + \cdots + a_k<em>M_k</em>M_k^{-1}$​</p>
<h3 id="表达整数的奇怪方式"><a href="#表达整数的奇怪方式" class="headerlink" title="表达整数的奇怪方式"></a>表达整数的奇怪方式</h3><blockquote>
<p>  <strong>题目描述</strong></p>
</blockquote>
<p>给定$2n$个正整数$a_1,a_2,\cdots,a_n$和$m_1,m_2,\cdots,m_n$，求一个最小的整数$x$，满足$\forall i \in [1,n], x \equiv m_i(mod\ a_i)$。</p>
<blockquote>
<p>  <strong>输入格式</strong></p>
</blockquote>
<p>第1行包含整数$n$。</p>
<p>第2到$n$行，每$i+1$行包含两个整数$a_i$和$m_i$，数之间用空格隔开。</p>
<blockquote>
<p>  <strong>输出格式</strong></p>
</blockquote>
<p>输出整数$x$，如果$x$不存在，则输出-1.</p>
<blockquote>
<p>  <strong>数据范围</strong></p>
</blockquote>
<p>$1 \le a_i \le 2^{31}-1$​,</p>
<p>$0 \le m_i \le a_i$</p>
<blockquote>
<p>  <strong>输入样例</strong></p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">2</span><br><span class="line">8 7</span><br><span class="line">11 9</span><br></pre></td></tr></table></figure>
<blockquote>
<p>  <strong>输出样例</strong></p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">31</span><br></pre></td></tr></table></figure>
<blockquote>
<p>  <strong>实现代码</strong></p>
</blockquote>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="type">long</span> <span class="type">long</span> ll;</span><br><span class="line"></span><br><span class="line"><span class="function">ll <span class="title">exgcd</span><span class="params">(ll a, ll b, ll &amp;x, ll &amp;y)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (!b) &#123;</span><br><span class="line">        x = <span class="number">1</span>, y = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">return</span> a;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    ll d = <span class="built_in">exgcd</span>(b, a%b, y, x);</span><br><span class="line">    y -= a/b * x;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> d;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="type">int</span> n;</span><br><span class="line">    cin &gt;&gt; n;</span><br><span class="line">    </span><br><span class="line">    <span class="type">bool</span> flag = <span class="literal">true</span>;</span><br><span class="line">    ll a1, m1;</span><br><span class="line">    </span><br><span class="line">    cin &gt;&gt; a1 &gt;&gt; m1;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; n - <span class="number">1</span>; ++i) &#123;</span><br><span class="line">        ll a2, m2;</span><br><span class="line">        cin &gt;&gt; a2 &gt;&gt; m2;</span><br><span class="line">        </span><br><span class="line">        ll k1, k2;</span><br><span class="line">        ll d = <span class="built_in">exgcd</span>(a1, a2, k1, k2);</span><br><span class="line">        <span class="keyword">if</span> ((m2-m1) % d) &#123;</span><br><span class="line">            flag = <span class="literal">false</span>;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        k1 *= (m2-m1)/d;</span><br><span class="line">        ll t = a2/d;</span><br><span class="line">        k1 = (k1%t + t) % t; <span class="comment">// k1可能为负，因此要如此取模</span></span><br><span class="line">        </span><br><span class="line">        m1 = a1 * k1 * m1;</span><br><span class="line">        a1 = <span class="built_in">abs</span>(a1/d*a2);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (flag) cout &lt;&lt; (m1 % a1 + a1) % a1 &lt;&lt; endl;</span><br><span class="line">    <span class="keyword">else</span> cout &lt;&lt; <span class="string">&quot;-1\n&quot;</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="高斯消元"><a href="#高斯消元" class="headerlink" title="高斯消元"></a>高斯消元</h2><p>可以在$O(n^3)$的时间复杂度，求解$n$元线性方程组。</p>
<p>$n$元线性方程组的解有三种情况：</p>
<ol>
<li><p>无解</p>
<p>初等行列变换后，存在0=b的情况</p>
</li>
<li><p>无穷多组解</p>
<p>初等行列变换后，存在0=0的情况</p>
</li>
<li><p>唯一解</p>
<p>其他情况</p>
</li>
</ol>
<p><strong>「实现思路」</strong></p>
<p>先枚举每一列，即一列一列地消除：</p>
<ol>
<li><p>找到绝对值最大的一行</p>
</li>
<li><p>将该行换到最上面</p>
</li>
<li><p>将该行第一个数变成1</p>
<p>这一行所有元素同时除以第一个数，实际应该最后改变第一个数的值</p>
</li>
<li><p>将下面所有行的第c列消成0</p>
</li>
</ol>
<p>消除完成后再从下往上，从右往左，将对角线右上角化为0。最终结果为最后一列对应的值。</p>
<h3 id="高斯消元解线性方程组"><a href="#高斯消元解线性方程组" class="headerlink" title="高斯消元解线性方程组"></a>高斯消元解线性方程组</h3><blockquote>
<p>  <strong>题目描述</strong></p>
</blockquote>
<p>输入一个包含n个方程n个未知数的线性方程组。</p>
<p>$\begin{cases} a<em>{11}x</em>{11} + a<em>{12}x</em>{12} + \cdots + a<em>{1n}x</em>{1n} = b<em>1 \ a</em>{21}x<em>{21} + a</em>{22}x<em>{22} + \cdots + a</em>{2n}x<em>{2n} = b_2 \ \qquad \qquad\qquad\quad \vdots \ a</em>{n1}x<em>{n1} + a</em>{n2}x<em>{n2} + \cdots + a</em>{nn}x_{nn} = b_n \end{cases}$</p>
<p>方程组中的系数为实数。求解这个方程组。</p>
<blockquote>
<p>  <strong>输入格式</strong></p>
</blockquote>
<p>第1行包含整数$n$。</p>
<p>接下来n行，每行包含n+1个实数，表示一个方程的n个系数以及等号右侧的常数</p>
<blockquote>
<p>  <strong>输出格式</strong></p>
</blockquote>
<p>如果给定线性方程组存在唯一解，则输出共n行，其中第i喊输出第i个未知数的解，结果保留两位小数。</p>
<p>如果给定线性方程组存在无效解，则输出“Infinite group solutions”。</p>
<p>如果给定线性方程组无解，则输出“No solutions”</p>
<blockquote>
<p>  <strong>数据范围</strong></p>
</blockquote>
<p>$1 \le n \le 100$，</p>
<p>所有输入系数以及常数均保留两位小数，绝对值均不超过100。</p>
<blockquote>
<p>  <strong>输入样例</strong></p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">3</span><br><span class="line">1.00 2.00 -1.00 -6.00</span><br><span class="line">2.00 1.00 -3.00 -9.00</span><br><span class="line">-1.00 -1.00 2.00 7.00</span><br></pre></td></tr></table></figure>
<blockquote>
<p>  <strong>输出样例</strong></p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">1.00</span><br><span class="line">-2.00</span><br><span class="line">3.00</span><br></pre></td></tr></table></figure>
<blockquote>
<p>  <strong>实现代码</strong></p>
</blockquote>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;cmath&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N = <span class="number">110</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">double</span> eps = <span class="number">1e-6</span>;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> n;</span><br><span class="line"><span class="type">double</span> a[N][N];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">gauss</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="type">int</span> c, r; <span class="comment">// c 表示枚举的列，r表示枚举的行</span></span><br><span class="line">    <span class="keyword">for</span> (c = <span class="number">0</span>, r = <span class="number">0</span>; c &lt; n; ++c) &#123;</span><br><span class="line">        <span class="type">int</span> t = r;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 找到绝对值最大的一行</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = r; i &lt; n; ++i) <span class="keyword">if</span> (<span class="built_in">fabs</span>(a[i][c] &gt; <span class="built_in">fabs</span>(a[t][c]))) t = i;</span><br><span class="line">        <span class="keyword">if</span> (<span class="built_in">fabs</span>(a[t][c]) &lt; eps) <span class="keyword">continue</span>; <span class="comment">// 如果这一行最大的数的绝对值为0，直接枚举下一行</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">// 将该行换到当前遍历行的最上一行，即绝对值最大的行t 与 当前行r进行交换</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = c; i &lt;= n; ++i) <span class="built_in">swap</span>(a[t][i], a[r][i]);</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 将该行第一个数变成1</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = n; i &gt;= c; i--) a[r][i] /= a[r][c];</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 将下面所有行的第c列消成0</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = r + <span class="number">1</span>; i &lt; n; ++i)</span><br><span class="line">            <span class="keyword">if</span> (<span class="built_in">fabs</span>(a[i][c]) &gt; eps) <span class="comment">// 当前数不为0才有意义</span></span><br><span class="line">                <span class="keyword">for</span> (<span class="type">int</span> j = n; j &gt;= c; --j)</span><br><span class="line">                    a[i][j] -= a[r][j] * a[i][c];</span><br><span class="line"></span><br><span class="line">        r++;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (r &lt; n) &#123; <span class="comment">// 不是唯一解</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = r; i &lt; n; ++i)</span><br><span class="line">            <span class="keyword">if</span> (<span class="built_in">fabs</span>(a[i][n] &gt; eps)) <span class="keyword">return</span> <span class="number">2</span>; <span class="comment">// 无解</span></span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span>; <span class="comment">// 有无穷多组解</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 有解，求出解，消除右上角</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = n<span class="number">-1</span>; i &gt;= <span class="number">0</span>; --i)</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = i+<span class="number">1</span>; j &lt; n; ++j)</span><br><span class="line">            a[i][n] -= a[i][j] * a[j][n];</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>; <span class="comment">// 唯一解</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    cin &gt;&gt; n;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; n; ++i)</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>;j &lt; n + <span class="number">1</span>; ++j)</span><br><span class="line">            cin &gt;&gt; a[i][j];</span><br><span class="line"></span><br><span class="line">    <span class="type">int</span> t = <span class="built_in">gauss</span>();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (t == <span class="number">0</span>) &#123; <span class="comment">// 唯一解</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; n; ++i) cout &lt;&lt; a[i][n] &lt;&lt; endl;</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (t == <span class="number">1</span>) &#123;</span><br><span class="line">        <span class="built_in">puts</span>(<span class="string">&quot;Infinite group solutions&quot;</span>);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="built_in">puts</span>(<span class="string">&quot;No solutions&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>  <strong>「每一步矩阵的变化情况」：</strong></p>
<p>  处理第0行第0列，第一步结束（无变化）<br>  1.00 2.00 -1.00 -6.00<br>  2.00 1.00 -3.00 -9.00<br>  -1.00 -1.00 2.00 7.00 </p>
<p>  处理第0行第0列，第二步结束（第0行与第1行交换）<br>  2.00 1.00 -3.00 -9.00<br>  1.00 2.00 -1.00 -6.00<br>  -1.00 -1.00 2.00 7.00 </p>
<p>  处理第0行第0列，第三步结束（第0行整体除<code>a[0][0]</code>）<br>  1.00 0.50 -1.50 -4.50<br>  1.00 2.00 -1.00 -6.00<br>  -1.00 -1.00 2.00 7.00 </p>
<p>  处理第0行第0列，第四步结束（1～2行的第i行第j列减去<code>a[i][0]*a[0][j]</code>）<br>  1.00 0.50 -1.50 -4.50<br>  0.00 1.50 0.50 -1.50<br>  0.00 -0.50 0.50 2.50 </p>
<p>  处理第1行第1列，第一步结束（无变化）<br>  1.00 0.50 -1.50 -4.50<br>  0.00 1.50 0.50 -1.50<br>  0.00 -0.50 0.50 2.50 </p>
<p>  处理第1行第1列，第二步结束（无变化，因为剩下两行里第1行第1列的值本来就是最大的，不需要交换）<br>  1.00 0.50 -1.50 -4.50<br>  0.00 1.50 0.50 -1.50<br>  0.00 -0.50 0.50 2.50 </p>
<p>  处理第1行第1列，第三步结束（第1行整体除<code>a[1][1]</code>）<br>  1.00 0.50 -1.50 -4.50<br>  0.00 1.00 0.33 -1.00<br>  0.00 -0.50 0.50 2.50 </p>
<p>  处理第1行第1列，第四步结束（2～2行的第i行第j列减去<code>a[i][1]*a[1][j]</code>））<br>  1.00 0.50 -1.50 -4.50<br>  0.00 1.00 0.33 -1.00<br>  0.00 0.00 0.67 2.00 </p>
<p>  处理第2行第2列，第一步结束（无变化）<br>  1.00 0.50 -1.50 -4.50<br>  0.00 1.00 0.33 -1.00<br>  0.00 0.00 0.67 2.00 </p>
<p>  处理第2行第2列，第二步结束（无变化，因为就剩下一行了，该行的第2列一定是最大的，不需要交换）<br>  1.00 0.50 -1.50 -4.50<br>  0.00 1.00 0.33 -1.00<br>  0.00 0.00 0.67 2.00 </p>
<p>  处理第2行第2列，第三步结束（第2行整体除<code>a[2][2]</code>）<br>  1.00 0.50 -1.50 -4.50<br>  0.00 1.00 0.33 -1.00<br>  0.00 0.00 1.00 3.00 </p>
<p>  处理第2行第2列，第四步结束（无变化，因为没有其他行的第2列需要被消为0）<br>  1.00 0.50 -1.50 -4.50<br>  0.00 1.00 0.33 -1.00<br>  0.00 0.00 1.00 3.00 </p>
<p>  最终判断有唯一解时，将右上角消为0后（这里不用实际变为0，只是修改最后一列值即可）<br>  1.00 0.50 -1.50 1.00<br>  0.00 1.00 0.33 -2.00<br>  0.00 0.00 1.00 3.00 </p>
</blockquote>
<h3 id="高斯消元解异或线性方程组"><a href="#高斯消元解异或线性方程组" class="headerlink" title="高斯消元解异或线性方程组"></a>高斯消元解异或线性方程组</h3><blockquote>
<p>  <strong>题目描述</strong></p>
</blockquote>
<p>输入一个包含$n$个方程$n$个未知数的异或线性方程组。</p>
<p>方程组中的系数和常数为0或1，每个未知数的取值也为0或1。</p>
<p>求解这个方程组。</p>
<p>异或线性方程组示例如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">M[1][1]x[1] ^ M[1][2]x[2] ^ ... ^ M[1][n]x[n] = B[1]</span><br><span class="line">M[2][1]x[1] ^ M[2][2]x[2] ^ ... ^ M[2][n]x[n] = B[2]</span><br><span class="line">...</span><br><span class="line">M[n][1]x[1] ^ M[n][2]x[2] ^ ... ^ M[n][n]x[n] = B[n]</span><br></pre></td></tr></table></figure>
<blockquote>
<p>  <strong>输入格式</strong></p>
</blockquote>
<p>第一行包含整数n。</p>
<p>接下来n行，每行包含$n+1$个整数0或1，表示一个方程的$n$个系数以及等号右侧的常数。</p>
<blockquote>
<p>  <strong>输出格式</strong></p>
</blockquote>
<p>如果给定线性方程组存在唯一解，则输出共$n$行，其中第$i$行输出第$i$个未知数的解。</p>
<p>如果给定线性方程组存在无数解，则输出”Infinite group solutions”。</p>
<p>如果给定线性方程组无解，则输出”No solution”。</p>
<blockquote>
<p>  <strong>数据范围</strong></p>
</blockquote>
<p>$1 \le n \le 100$​</p>
<blockquote>
<p>  <strong>输入样例</strong></p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">3</span><br><span class="line">1 1 0 1</span><br><span class="line">0 1 1 0</span><br><span class="line">1 0 0 1</span><br></pre></td></tr></table></figure>
<blockquote>
<p>  <strong>输出样例</strong></p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">1</span><br><span class="line">0</span><br><span class="line">0</span><br></pre></td></tr></table></figure>
<blockquote>
<p>  <strong>实现代码</strong></p>
</blockquote>
<p>异或运算等价于不进位的加法。所以可以看成线性方程。</p>
<ol>
<li>消成上三角矩阵<ol>
<li>枚举一列，找到非零行（非零即一，一即最大）</li>
<li>把非零行交换到最上面一行</li>
<li>将该列下面的行消为零（<strong>这里和线性方程组的消除方式不同</strong>）</li>
</ol>
</li>
<li>判断解<ol>
<li>完美上三角——唯一解</li>
<li>有矛盾（0=1或1=0）——无解</li>
<li>无矛盾——无穷解</li>
</ol>
</li>
</ol>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;algorithm&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N = <span class="number">110</span>;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> n;</span><br><span class="line"><span class="type">int</span> a[N][N];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">gauss</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="type">int</span> r, c;</span><br><span class="line">    <span class="keyword">for</span> (r = c = <span class="number">0</span>; c &lt; n; ++c) &#123;</span><br><span class="line">        <span class="comment">// 找到非零行</span></span><br><span class="line">        <span class="type">int</span> t = r; <span class="comment">// t表示非零行</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = r; i &lt; n; ++i)</span><br><span class="line">            <span class="keyword">if</span> (a[i][c]) &#123;</span><br><span class="line">                t = i;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        <span class="keyword">if</span> (!a[t][c]) <span class="keyword">continue</span>; <span class="comment">// 该列全为0，直接下一列，这样会导致少一次或多次r++，由此来判断是否是完美上三角</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">// 把该行(t)交换到最上行(r)</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = c; i &lt;= n; ++i) <span class="built_in">swap</span>(a[t][i], a[r][i]);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 将下面的行消为0</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = r+<span class="number">1</span>; i &lt; n; ++i)</span><br><span class="line">            <span class="keyword">if</span> (a[i][c])</span><br><span class="line">                <span class="keyword">for</span> (<span class="type">int</span> j = c; j &lt;= n; ++j)</span><br><span class="line">                    a[i][j] ^= a[r][j];</span><br><span class="line"></span><br><span class="line">        r++;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (r &lt; n) &#123; <span class="comment">// 有矛盾，不满足完美三角形</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = r; i &lt; n; ++i)</span><br><span class="line">            <span class="keyword">if</span> (a[i][n]) <span class="comment">// 有 0=1 的情况</span></span><br><span class="line">                <span class="keyword">return</span> <span class="number">2</span>; <span class="comment">// 无解</span></span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span>; <span class="comment">// 无穷多组解</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 有解，算出解</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = n<span class="number">-1</span>; i &gt;=<span class="number">0</span> ; --i)</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = i + <span class="number">1</span>; j &lt; n; ++j)</span><br><span class="line">            a[i][n] ^= a[i][j] &amp; a[j][n];</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>; <span class="comment">// 唯一解</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    cin &gt;&gt; n;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; n; ++i)</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>; j &lt; n + <span class="number">1</span>; ++j)</span><br><span class="line">            cin &gt;&gt; a[i][j];</span><br><span class="line"></span><br><span class="line">    <span class="type">int</span> res = <span class="built_in">gauss</span>();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (res == <span class="number">0</span>) </span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; n; ++i) cout &lt;&lt; a[i][n] &lt;&lt; endl;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> (res == <span class="number">1</span>) <span class="built_in">puts</span>(<span class="string">&quot;Infinite group solutions&quot;</span>);</span><br><span class="line">    <span class="keyword">else</span> <span class="built_in">puts</span>(<span class="string">&quot;No solution&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="组合数"><a href="#组合数" class="headerlink" title="组合数"></a>组合数</h2><p>$C_a^b = \frac{a<em>(a-1)</em>\cdots<em>(a-b+1)}{1</em>2<em>3</em>\cdots*b} = \frac{a!}{b!(a-b)!}$​</p>
<ul>
<li><p>求组合数I</p>
<p>10万询问，$1\le b \le a \le 2000$</p>
<p>递推，$O(N^2)$</p>
</li>
<li><p>求组合数II</p>
<p>10万询问，$1\le b \le a \le 10^5$</p>
<p>预处理$i!$和$(i!)^{-1}$，$O(N*logN)$</p>
</li>
<li><p>求组合数III</p>
<p>20询问，$1 \le b \le a \le 10^{18}$​，$1 \le p \le 10^5$​</p>
<p>卢卡斯定理，$O(p <em>\log N </em>\log p)$​</p>
</li>
<li><p>求组合数IV</p>
<p>不能取模，值很大，需要用高精度。$1 \le b \le a \le 5000$​</p>
</li>
</ul>
<h3 id="求组合数I"><a href="#求组合数I" class="headerlink" title="求组合数I"></a>求组合数I</h3><blockquote>
<p>  <strong>题目描述</strong></p>
</blockquote>
<p>给定$n$组询问，每组询问给定两个整数$a,b$，请你输出$C_a^b\;mod\ (10^9+7)$的值。</p>
<blockquote>
<p>  <strong>输入格式</strong></p>
</blockquote>
<p>第一行包含整数n。</p>
<p>接下来n行，每行包含一组$a$和$b$。</p>
<blockquote>
<p>  <strong>输出格式</strong></p>
</blockquote>
<p>共输出n行，每行输出一个询问的解。</p>
<blockquote>
<p>  <strong>数据范围</strong></p>
</blockquote>
<p>$1 \le n \le 10^5$​,</p>
<p>$1 \le b \le a \le 2000$</p>
<blockquote>
<p>  <strong>输入样例</strong></p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">3</span><br><span class="line">3 1</span><br><span class="line">5 3</span><br><span class="line">2 2</span><br></pre></td></tr></table></figure>
<blockquote>
<p>  <strong>输出样例</strong></p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">3</span><br><span class="line">10</span><br><span class="line">1</span><br></pre></td></tr></table></figure>
<blockquote>
<p>  <strong>实现代码</strong></p>
</blockquote>
<p>根据数据范围可以分析出不能用暴力来做，发现a，b的取值较小，所以可以先预处理出来，这里主要利用递推式（定理）：$C<em>a^b=C</em>{a-1}^b+C_{a-1}^{b-1}$</p>
<p>有了这个递推式后，直接用DP的做法来实现代码(初始状态为$C_i^0\quad i\in$)：</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N = <span class="number">2010</span>, mod = <span class="number">1e9</span>+<span class="number">7</span>;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> c[N][N];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">init</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; N; ++i)</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>; j &lt;= i; ++j)</span><br><span class="line">            <span class="keyword">if</span> (!j) c[i][j] = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">else</span> c[i][j] = (c[i<span class="number">-1</span>][j] + c[i<span class="number">-1</span>][j<span class="number">-1</span>])%mod;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">init</span>();</span><br><span class="line">    </span><br><span class="line">    <span class="type">int</span> n;</span><br><span class="line">    cin &gt;&gt; n;</span><br><span class="line">    <span class="keyword">while</span> (n--) &#123;</span><br><span class="line">        <span class="type">int</span> a, b;</span><br><span class="line">        cin &gt;&gt; a &gt;&gt; b;</span><br><span class="line">        cout &lt;&lt; c[a][b] &lt;&lt; endl;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="求组合数II"><a href="#求组合数II" class="headerlink" title="求组合数II"></a>求组合数II</h3><blockquote>
<p>  <strong>题目描述</strong></p>
</blockquote>
<p>给定$n$组询问，每组询问给定两个整数$a,b$，请你输出$C_a^b\;mod\ (10^9+7)$的值。</p>
<blockquote>
<p>  <strong>输入格式</strong></p>
</blockquote>
<p>第一行包含整数n。</p>
<p>接下来n行，每行包含一组$a$和$b$。</p>
<blockquote>
<p>  <strong>输出格式</strong></p>
</blockquote>
<p>共输出n行，每行输出一个询问的解。</p>
<blockquote>
<p>  <strong>数据范围</strong></p>
</blockquote>
<p>$1 \le n \le 10^5$​,</p>
<p>$1 \le b \le a \le 10^5$</p>
<blockquote>
<p>  <strong>输入样例</strong></p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">3</span><br><span class="line">3 1</span><br><span class="line">5 3</span><br><span class="line">2 2</span><br></pre></td></tr></table></figure>
<blockquote>
<p>  <strong>输出样例</strong></p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">3</span><br><span class="line">10</span><br><span class="line">1</span><br></pre></td></tr></table></figure>
<blockquote>
<p>  <strong>实现代码</strong></p>
</blockquote>
<p>这一道题的询问和上一道题一样，也就是说时间复杂度不允许使用暴力方法。同时这道题的a，b的取值范围也比上一题更大，因此也不能再用上一题的递推来做了。</p>
<p>根据定义：$C_a^b=\frac{a!}{(a-b)!b!}$</p>
<p>这道题可以预处理阶乘（$feet[i]=i! \% (10^9+7)$）来做。</p>
<p>但是$\frac{a}{b} \; mod\ p \not = \frac{a\;mod p}{b\;mod\ p}$。因此要用逆元来将乘法转换为乘法（$infact[i]=(i!)^{-1} \% (10^9+7)$）。</p>
<p>因此问题转换为：$C_a^b=fact[a]<em>infact[b-a]</em>infact[b]$</p>
<p>这里可以用<a href="#快速幂求逆元">快速幂求逆元</a>来求逆元。</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">typedef</span> <span class="type">long</span> <span class="type">long</span> ll;</span><br><span class="line"></span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N = <span class="number">100010</span>, mod = <span class="number">1e9</span>+<span class="number">7</span>;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> fact[N], infact[N];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">qmi</span><span class="params">(<span class="type">int</span> a, <span class="type">int</span> k, <span class="type">int</span> p)</span> </span>&#123;</span><br><span class="line">    <span class="type">int</span> res = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span> (k) &#123;</span><br><span class="line">        <span class="keyword">if</span> (k&amp;<span class="number">1</span>) res = (ll)res * a % p;</span><br><span class="line">        k &gt;&gt;= <span class="number">1</span>;</span><br><span class="line">        a = (ll)a*a%p;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="comment">// 预处理阶乘和逆元的阶乘</span></span><br><span class="line">    fact[<span class="number">0</span>] = infact[<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt; N; ++i) &#123;</span><br><span class="line">        fact[i] = (ll)fact[i<span class="number">-1</span>]*i%mod;</span><br><span class="line">        infact[i] = (ll)infact[i<span class="number">-1</span>] * <span class="built_in">qmi</span>(i, mod<span class="number">-2</span>, mod) % mod;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="type">int</span> n;</span><br><span class="line">    cin &gt;&gt; n;</span><br><span class="line">    <span class="keyword">while</span> (n--) &#123;</span><br><span class="line">        <span class="type">int</span> a, b;</span><br><span class="line">        cin &gt;&gt; a &gt;&gt; b;</span><br><span class="line">        ll ans = (ll)fact[a]*infact[b]%mod*infact[a-b]%mod;</span><br><span class="line">        cout &lt;&lt; ans &lt;&lt; endl;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="求组合数III"><a href="#求组合数III" class="headerlink" title="求组合数III"></a>求组合数III</h3><blockquote>
<p>  <strong>题目描述</strong></p>
</blockquote>
<p>给定$n$组询问，每组询问给定三个整数$a,b,p$，其中$p$是质数，请你输出$C_a^b\;mod\ p$的值。</p>
<blockquote>
<p>  <strong>输入格式</strong></p>
</blockquote>
<p>第一行包含整数n。</p>
<p>接下来n行，每行包含一组$a,b,p$。</p>
<blockquote>
<p>  <strong>输出格式</strong></p>
</blockquote>
<p>共输出n行，每行输出一个询问的解。</p>
<blockquote>
<p>  <strong>数据范围</strong></p>
</blockquote>
<p>$1 \le n \le 20$​,</p>
<p>$1 \le b \le a \le 10^{18}$​</p>
<p>$1 \le p \le 10^5$</p>
<blockquote>
<p>  <strong>输入样例</strong></p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">3</span><br><span class="line">5 3 7</span><br><span class="line">3 1 5</span><br><span class="line">6 4 13</span><br></pre></td></tr></table></figure>
<blockquote>
<p>  <strong>输出样例</strong></p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">3</span><br><span class="line">3</span><br><span class="line">2</span><br></pre></td></tr></table></figure>
<blockquote>
<p>  <strong>实现代码</strong></p>
</blockquote>
<p><strong>「卢卡斯定理」：</strong>$C<em>a^b \equiv C</em>{a\;mod\ p}^{b\; mod\ p}*C_{a/p}^{b/p} (mod\ p)$</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">typedef</span> <span class="type">long</span> <span class="type">long</span> ll;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> p;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">qmi</span><span class="params">(<span class="type">int</span> a, <span class="type">int</span> k)</span> </span>&#123;</span><br><span class="line">    <span class="type">int</span> res = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span> (k) &#123;</span><br><span class="line">        <span class="keyword">if</span> (k&amp;<span class="number">1</span>) res = (ll)res*a%p;</span><br><span class="line">        k &gt;&gt;= <span class="number">1</span>;</span><br><span class="line">        a = (ll)a*a%p;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">C</span><span class="params">(<span class="type">int</span> a, <span class="type">int</span> b)</span> </span>&#123;</span><br><span class="line">    <span class="type">int</span> res = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>, j = a; i &lt;= b; ++i, j--) &#123;</span><br><span class="line">        res = (ll) res * j % p;</span><br><span class="line">        res = (ll)res*<span class="built_in">qmi</span>(i, p<span class="number">-2</span>)%p;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">lucas</span><span class="params">(ll a, ll b)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (a &lt; p &amp;&amp; b &lt; p) <span class="keyword">return</span> <span class="built_in">C</span>(a, b);</span><br><span class="line">    <span class="keyword">return</span> (ll) <span class="built_in">C</span>(a%p, b%p) * <span class="built_in">lucas</span>(a/p, b/p) %p;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="type">int</span> n;</span><br><span class="line">    cin &gt;&gt; n;</span><br><span class="line">    <span class="keyword">while</span> (n--) &#123;</span><br><span class="line">        ll a, b;</span><br><span class="line">        cin &gt;&gt; a &gt;&gt; b &gt;&gt; p;</span><br><span class="line">        cout &lt;&lt; <span class="built_in">lucas</span>(a, b) &lt;&lt; endl;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>
<h3 id="求组合数IV"><a href="#求组合数IV" class="headerlink" title="求组合数IV"></a>求组合数IV</h3><blockquote>
<p>  <strong>题目描述</strong></p>
</blockquote>
<p>输入$a,b$，求$C_a^b$的值。</p>
<p>注意结果可能很大，需要使用高精度计算。</p>
<blockquote>
<p>  <strong>输入格式</strong></p>
</blockquote>
<p>共一行，包含两个整数$a$和$b$</p>
<blockquote>
<p>  <strong>输出格式</strong></p>
</blockquote>
<p>共一行，输出$C_a^b$的值。</p>
<blockquote>
<p>  <strong>数据范围</strong>$​</p>
</blockquote>
<p>$1 \le b \le a \le 5000$</p>
<blockquote>
<p>  <strong>输入样例</strong></p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">5 3</span><br></pre></td></tr></table></figure>
<blockquote>
<p>  <strong>输出样例</strong></p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">10</span><br></pre></td></tr></table></figure>
<blockquote>
<p>  <strong>实现代码</strong></p>
</blockquote>
<p>这道题要用高精度来计算，但是数据范围还是比较大，而且涉及到高精度乘法和高精度除法，因此考虑把高精度除法也转换为乘法。这里就可以使用基本算数定理，将分子分母用质数表示出来，最终给质数进行高精度乘法。</p>
<p>即：$C_a^b=\frac{a!}{(a-b)!b!}$，其中$a! = p_1^{\alpha_1}p_2^{\alpha_2}\cdots p_k^{\alpha_k},(a-b)!b! = p_1^{\beta_1}p_2^{\beta_2}\cdots p_m^{\beta_m}$，</p>
<p>则$C_a^b=p_1^{\alpha_1-\beta_1}p_2^{\alpha_2-\beta_2}\cdots p_m^{\alpha_m-\beta_m}\cdots p_k^{\alpha_a-\alpha_k}$​</p>
<p>其中分子或分母没有的质数的指数当然是0，也可以计算。</p>
<p><strong>「分解$a!$的质因数」：</strong></p>
<p>例如讨论它的某一个质数$p$。则$a! = \lfloor\frac{a}{p}\rfloor + \lfloor\frac{a}{p^2}\rfloor+\cdots+\lfloor\frac{a}{p^k}\rfloor$。$\lfloor\frac{a}{p}\rfloor$表示1～a中p的倍数的个数。</p>
<p>因此本题思路为：</p>
<ol>
<li><p><a href="#筛质数">筛质数</a></p>
<p>将2～5000中的质数筛选出来</p>
</li>
<li><p>分解质因数</p>
<p>分解分子和分母的质因数</p>
</li>
<li><p>高精度乘法</p>
</li>
</ol>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;vector&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N = <span class="number">5010</span>;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> primes[N], cnt;</span><br><span class="line"><span class="type">bool</span> st[N];</span><br><span class="line"><span class="type">int</span> sum[N]; <span class="comment">// 每个质数的次数</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">get_primes</span><span class="params">(<span class="type">int</span> n)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">2</span>; i &lt;= n; ++i) &#123;</span><br><span class="line">        <span class="keyword">if</span> (!st[i]) primes[cnt++] = i;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>; primes[j] &lt;= n/i; ++j) &#123;</span><br><span class="line">            st[primes[j]*i] = <span class="literal">true</span>;</span><br><span class="line">            <span class="keyword">if</span> (i%primes[j] == <span class="number">0</span>) <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 求n中包含p的个数</span></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">get</span><span class="params">(<span class="type">int</span> n, <span class="type">int</span> p)</span> </span>&#123;</span><br><span class="line">    <span class="type">int</span> res = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span>(n) &#123;</span><br><span class="line">        res += n/p;</span><br><span class="line">        n /= p;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">mul</span><span class="params">(vector&lt;<span class="type">int</span>&gt; a, <span class="type">int</span> b)</span> </span>&#123;</span><br><span class="line">    vector&lt;<span class="type">int</span>&gt; c;</span><br><span class="line">    <span class="type">int</span> t = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; a.<span class="built_in">size</span>(); ++i) &#123;</span><br><span class="line">        t += a[i] * b;</span><br><span class="line">        c.<span class="built_in">push_back</span>(t%<span class="number">10</span>);</span><br><span class="line">        t /= <span class="number">10</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span> (t) &#123;</span><br><span class="line">        c.<span class="built_in">push_back</span>(t%<span class="number">10</span>);</span><br><span class="line">        t /= <span class="number">10</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> c;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="type">int</span> a, b;</span><br><span class="line">    cin &gt;&gt; a &gt;&gt; b;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 筛质数</span></span><br><span class="line">    <span class="built_in">get_primes</span>(a);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 分解质因数</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; cnt; ++i) </span><br><span class="line">        sum[i] = <span class="built_in">get</span>(a, primes[i]) - <span class="built_in">get</span>(b, primes[i]) - <span class="built_in">get</span>(a-b, primes[i]);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 高精度乘法</span></span><br><span class="line">    vector&lt;<span class="type">int</span>&gt; res;</span><br><span class="line">    res.<span class="built_in">push_back</span>(<span class="number">1</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; cnt; ++i)</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>; j &lt; sum[i]; ++j)</span><br><span class="line">            res = <span class="built_in">mul</span>(res, primes[i]);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 输出结果</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = res.<span class="built_in">size</span>()<span class="number">-1</span>; i&gt;=<span class="number">0</span>; --i) cout &lt;&lt; res[i];</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="满足条件的01序列"><a href="#满足条件的01序列" class="headerlink" title="满足条件的01序列"></a>满足条件的01序列</h3><blockquote>
<p>  <strong>题目描述</strong></p>
</blockquote>
<p>给定n个0和n个1，它们将按照某种顺序拍成长度为2n的序列，求它们能排列成的所有序列中，能够满足任意前缀序列中0的个数都不少于1的序列有多少个。</p>
<p>输出的答案对$10^9+7$取模。</p>
<blockquote>
<p>  <strong>输入格式</strong></p>
</blockquote>
<p>共一行，包含整数n。</p>
<blockquote>
<p>  <strong>输出格式</strong></p>
</blockquote>
<p>共一行，包含一个整数，表示答案。</p>
<blockquote>
<p>  <strong>数据范围</strong>$​</p>
</blockquote>
<p>$1 \le n \le 10^5$</p>
<blockquote>
<p>  <strong>输入样例</strong></p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">3</span><br></pre></td></tr></table></figure>
<blockquote>
<p>  <strong>输出样例</strong></p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">5</span><br></pre></td></tr></table></figure>
<ul>
<li><p>提示：</p>
<p>000111</p>
<p>001101</p>
<p>001011</p>
<p>010011</p>
<p>010101</p>
</li>
</ul>
<blockquote>
<p>  <strong>实现代码</strong></p>
</blockquote>
<p>所有方案数为:$C<em>{2n}^n$，不合法的方案数为$C</em>{2n}^{n-1}$</p>
<p>因此，最终方案数为：$C<em>{2n}^n-C</em>{2n}^{n-1} = \frac{C_{2n}^n}{n+1}$</p>
<p>这样的数被称为<strong>「卡特兰数」</strong>。</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">typedef</span> <span class="type">long</span> <span class="type">long</span> ll;</span><br><span class="line"></span><br><span class="line"><span class="type">const</span> <span class="type">int</span> mod = <span class="number">1e9</span>+<span class="number">7</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">qmi</span><span class="params">(<span class="type">int</span> a, <span class="type">int</span> k, <span class="type">int</span> p)</span> </span>&#123;</span><br><span class="line">    <span class="type">int</span> res = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span> (k) &#123;</span><br><span class="line">        <span class="keyword">if</span> (k&amp;<span class="number">1</span>) res = (ll)res*a%p;</span><br><span class="line">        a = (ll)a*a%p;</span><br><span class="line">        k &gt;&gt;= <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="type">int</span> n;</span><br><span class="line">    cin &gt;&gt; n;</span><br><span class="line"></span><br><span class="line">    <span class="type">int</span> a = <span class="number">2</span>*n, b = n;</span><br><span class="line">    <span class="type">int</span> res = <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 求a！/(a-b)!</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = a; i &gt; a-b; --i) res = (ll) res *i%mod;</span><br><span class="line">    <span class="comment">// 求b!^&#123;-1&#125;</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= b; ++i) res = (ll) res*<span class="built_in">qmi</span>(i, mod<span class="number">-2</span>, mod) %mod;</span><br><span class="line"></span><br><span class="line">    res = (ll) res*<span class="built_in">qmi</span>(n+<span class="number">1</span>, mod<span class="number">-2</span>, mod) % mod;</span><br><span class="line"></span><br><span class="line">    cout &lt;&lt; res &lt;&lt; endl;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>代码中先求$\frac{a!}{(a-b)!}$,然后用快速幂求1～b的逆元，并累乘，求得$b!^{-1}$</p>
<p>乘得结果为$\frac{a!}{(a-b)!b!} = C<em>a^b = C</em>{2n}^n$</p>
<p>最后再乘$n+1$的逆元，与前面的结果相乘即可。</p>
<h2 id="容斥原理"><a href="#容斥原理" class="headerlink" title="容斥原理"></a>容斥原理</h2><p><a target="_blank" rel="noopener external nofollow noreferrer" href="https://baike.baidu.com/item/容斥原理/10146840#:~:text=在计数时，必须注意没有重复，没有遗漏%E3%80%82,为了使重叠部分不被重复计算，人们研究出一种新的计数方法，这种方法的基本思想是：先不考虑重叠的情况，把包含于某内容中的所有对象的数目先计算出来，然后再把计数时重复计算的数目排斥出去，使得计算的结果既无遗漏又无重复，这种计数的方法称为容斥原理%E3%80%82" title="百度百科定义">百度百科定义</a></p>
<p>在<a target="_blank" rel="noopener external nofollow noreferrer" href="https://baike.baidu.com/item/计数/9276342?fromModule=lemma_inlink">计数</a>时，必须注意没有重复，没有遗漏。为了使<a target="_blank" rel="noopener external nofollow noreferrer" href="https://baike.baidu.com/item/重叠/9009438?fromModule=lemma_inlink">重叠</a>部分不被重复计算，人们研究出一种新的计数方法，这种方法的基本思想是：先不考虑重叠的情况，把包含于某内容中的所有对象的数目先计算出来，然后再把计数时重复计算的数目<a target="_blank" rel="noopener external nofollow noreferrer" href="https://baike.baidu.com/item/排斥/10717656?fromModule=lemma_inlink">排斥</a>出去，使得计算的结果既无遗漏又无重复，这种计数的方法称为容斥原理。 </p>
<p>以三个集合举例：</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://pic2.zhimg.com/80/v2-cffcfe0291304d3f5b8548876c1dffd1_1440w.png" alt="容斥定理" title="举例VN图"></p>
<p>要求集合元素个数（VN图包含面积），就是$A \cup B \cup C - A\cap B - B\cap C-A \cap C + A \cap B\cap C$​</p>
<h3 id="能被整除的数"><a href="#能被整除的数" class="headerlink" title="能被整除的数"></a>能被整除的数</h3><blockquote>
<p>  <strong>题目描述</strong></p>
</blockquote>
<p>给定一个整数$n$和$m$个不同的质数$p_1,p_2,\cdots, p_m$。</p>
<p>请你求出$1$~$n$中能被$p_1,p_2,\cdots,p_m$中的至少一个数整出的整数有多少个</p>
<blockquote>
<p>  <strong>输入格式</strong></p>
</blockquote>
<p>第一行包含整数$n$和$m$。</p>
<p>第二行包含$m$个质数。</p>
<blockquote>
<p>  <strong>输出格式</strong></p>
</blockquote>
<p>共一行，包含一个整数，表示满足条件的整数的个数。</p>
<blockquote>
<p>  <strong>数据范围</strong></p>
</blockquote>
<p>$1 \le m \le 16$,</p>
<p>$1\le n,p_i\le10^9$</p>
<blockquote>
<p>  <strong>输入样例</strong></p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">10 2</span><br><span class="line">2 3</span><br></pre></td></tr></table></figure>
<blockquote>
<p>  <strong>输出样例</strong></p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">7</span><br></pre></td></tr></table></figure>
<blockquote>
<p>  <strong>实现代码</strong></p>
</blockquote>
<p>根据样例可以如下转化：</p>
<p>$s_1:{2,4,6,8,10};s_2:{3,6,9}$，即用$s_1$表示2的倍数的集合，$s_2$表示3的倍数的集合。最终要求的结果即为$|s_1 \cup s_2| = |s_1|+|s_2|-|s_1 \cap s_2| = 5 + 3 - 1 = 7$</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="type">long</span> <span class="type">long</span> ll;</span><br><span class="line"></span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N = <span class="number">20</span>;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> n, m;</span><br><span class="line"><span class="type">int</span> p[N];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    cin &gt;&gt; n &gt;&gt; m;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; m; ++i) cin &gt;&gt; p[i];</span><br><span class="line"></span><br><span class="line">    <span class="type">int</span> res = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt; <span class="number">1</span> &lt;&lt; m; ++i) &#123;</span><br><span class="line">        <span class="type">int</span> t = <span class="number">1</span>, cnt = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>; j &lt; m; ++j) &#123;</span><br><span class="line">            <span class="keyword">if</span> (i &gt;&gt; j &amp; <span class="number">1</span>) &#123;</span><br><span class="line">                cnt ++;</span><br><span class="line">                <span class="keyword">if</span> ((ll)t*p[j] &gt; n) &#123;</span><br><span class="line">                    t = <span class="number">-1</span>;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                &#125;</span><br><span class="line">                t *= p[j];</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (t != <span class="number">-1</span>) &#123;</span><br><span class="line">            <span class="keyword">if</span> (cnt % <span class="number">2</span>) res += n/t; <span class="comment">// 奇数个集合</span></span><br><span class="line">            <span class="keyword">else</span> res -= n/t;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    cout &lt;&lt; res &lt;&lt; endl;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="简单博弈论"><a href="#简单博弈论" class="headerlink" title="简单博弈论"></a>简单博弈论</h2><ul>
<li><p>NIM游戏</p>
<p>给定$N$堆物品，第$i$堆物品有$A_i$个。两名玩家轮流行动，每次可以任选一堆，取走任意多个物品，可把一堆取关，但不能不取。取走最后一件物品者获胜。两人都采取最优策略。问娴熟是否必胜。</p>
<p>我们吧这种游戏称为「NIM博弈」。把游戏过程中面临的状态称为「局面」。整局游戏第一个行动的称为「先手」，第二个行动的称为「后手」。若在某一局面下，无论采取何种行动，都会输掉游戏，则称改局游戏结束。</p>
<p>所谓采取最优策略是指，若在某一局面下存在某种行动，使得行动后对面面临必败局面，则优先采取该行动。同时，这样的局面被称为「必胜」。我们讨论博弈问题一般都只考虑理想情况。</p>
<p><strong>NIM博弈不存在平局，至于先手必胜和先手必败两种情况。</strong></p>
<p>定理：NIM博弈先手必胜，当且仅当$A_1 \oplus A_2 \oplus \cdots \oplus A_n \not= 0$。证明见<a href="#Nim游戏" title="Nim游戏定理证明">Nim游戏</a></p>
</li>
<li><p>公平组合游戏ICG</p>
<p>若一个游戏满足：</p>
<ol>
<li>由两名玩家交替行动</li>
<li>在游戏进程的任意时刻，可以执行的合法行为与轮到哪名玩家无关</li>
<li>不能行动的玩家判负</li>
</ol>
<p>则称该游戏为一个公平组合游戏。</p>
<p><strong>NIM博弈属于公平组合游戏</strong>，但常见的棋类游戏，比如围棋，就是不公平组合游戏。因为围棋交战双方智能落黑子和白子，胜负判定也比较复杂，不能满足第二条和第三条</p>
</li>
<li><p>有向图游戏</p>
<p>给定一个有向无环图，图中有一个唯一的起点，在起点上放有一枚棋子。两名玩家交替地把这枚棋子沿有向边进行移动，每次可以移动一步，无法移动者判负，该游戏称为有向图游戏。</p>
<p><strong>任何一个公平组合游戏都可以转换为有向图游戏。</strong>具体方法是：把每个局面看成图中的一个节点，并且从每个局面沿着合法行动能够到达的下一个局面连有向边。</p>
</li>
<li><p>Mex运算</p>
<p>设$S$表示一个非负整数。定义$mex(S)$为求出不属于集合$S$的最小非负整数运算，即：</p>
<p>$mex(S)=min(x)$，$x\in N,x \not\in S$​</p>
</li>
<li><p>SG函数</p>
<p>在有向图游戏中，对于每个节点$x$，设从$x$出发共有$k$条有向边，分别到达节点$y_1,y_2,\cdots,y_k$，定义$SG(x)$为$x$的后继节点$y_1,y_2,\cdots,y_k$的SG函数值构成的集合再执行$mex(S)$运算的结果，即：$SG(x)=mex(SG(y_1),SG(y_2),\cdots,SG(y_k))$</p>
<p>特别地，整个有向图游戏的SG函数值被定义为有向图游戏起点$s$的SG函数值，即$SG(G)=SG(s)$</p>
</li>
</ul>
<h3 id="Nim游戏"><a href="#Nim游戏" class="headerlink" title="Nim游戏"></a>Nim游戏</h3><p>NIM游戏属于公平组合游戏。</p>
<p>如果有$n$堆石子，每堆石子的个数分别为：$a_1, a_2, a_3, a_4,\cdots a_n$，若：$a_1 \oplus a_2 \oplus \cdots \oplus a_n \not= 0$ 则先手必胜，否则先手必输。</p>
<p><strong>证明：</strong></p>
<p>操作到最后的时候有（必败状态）： $0 \oplus 0  \oplus \cdots \oplus 0 = 0$。即每次操作的最优策略就是把剩下的石子的异或值变成0。</p>
<ul>
<li><p>若当前的异或和不为$0$即$a_1\oplus a_2\oplus \cdots \oplus a_n = x \not=0$,则一定可以通过某种方式使他们的异或和变成$0$，也就是说一定可以通过某种方式从某一堆里面拿走若干个石子，让剩下的这些数的异或值变成$0$</p>
<p>假设$x$的二进制表示中最高的一位是第$k$位，那么就说明，$a_1$ ~ $a_n$中一定至少存在某一个数$a_i$它的二进制第$k$位为$1$，如果不存在，那很显然不会出现$x$的第$k$位为$1$</p>
<p>那么就一定会有：$a_i \oplus x \lt a_i$，因为$x$第$k$位之前的位全为$0$与$a_i$进行异或的时候数值不变，但是第$k$位异或后一定变成$0$，所以运算结果会更小</p>
<p>于是接下来，从$a_i$这一堆中拿走$a_i-(a_i \oplus x)$这么多的石子，那么此时$ai$这一堆的石子个数就变成了$a_i \oplus x$</p>
<p>那么剩下的所有堆的石子进行异或就是$a_1\oplus a_2\oplus \cdots \oplus ( a_i\oplus x) \oplus\cdots \oplus a_n = x \oplus x = 0$</p>
</li>
<li><p>若当前$a_1\oplus a_2 \oplus \cdots \oplus a_n=x=0$，那么无论不管怎么拿，最后得到剩下石子堆进行异或的结果一定不是$0$</p>
<p>假设从$a<em>i$中拿了一些石子变成$ai’$使得$a_1\oplus a_2 \oplus \cdots \oplus a_i’ \oplus a</em>{i+1} \oplus \cdots \oplus a_n = x = 0$</p>
<p>将$a<em>1\oplus a_2 \oplus \cdots \oplus a_n = x = 0$与$a_1\oplus a_2 \oplus \cdots \oplus a_i’ \oplus a</em>{i+1} \oplus \cdots \oplus a_n = x = 0$的等式两边分别进行异或，可以得到：$a_i \oplus a_i’ = 0$，但是很显然这两个数是不一样的，所以出现矛盾</p>
<p>所以不管怎么拿最后剩下的石子异或的结果一定不是$0$</p>
</li>
</ul>
<p>所以当先手遇到的异或的值不为$0$的话，一定可以拿走一些石子使得后手面对的局面异或值为$0$，且后手不管怎么拿留给先手的异或值必然不为$0$，而由于游戏一定可以结束，从而到最后的时候先手拿走最后一些石子，留给后手无石子可拿，<strong>先手必赢</strong>。</p>
<p>那么反过来，如果先手遇到的异或值为0，则留给后手的异或值一定不是0，后手一定可以拿走一些石子把接下来的异或值为0留给先手，在整个游戏过程中先手遇到的都是异或值为0的状态，到最后<strong>先手必输</strong>。</p>
<blockquote>
<p>  <strong>题目描述</strong></p>
</blockquote>
<p>给定$n$堆石子，两位玩家轮流操作，每次操作可以从任意一堆石子中拿走任意数量的石子（可以拿完，但不能不拿），最后无法进行操作的人视为失败。</p>
<p>问如果两人都采用最优策略，先手是否必胜。</p>
<blockquote>
<p>  <strong>输入格式</strong></p>
</blockquote>
<p>第一行包含整数$n$。</p>
<p>第二行包含$n$个数字$a1,a_2,\cdots,a_n$，其中第$i$个数字表示第$i$堆石子的数量。</p>
<blockquote>
<p>  <strong>输出格式</strong></p>
</blockquote>
<p>如果先手方必胜，则输出”Yes”。</p>
<p>否则，输出”No”。</p>
<blockquote>
<p>  <strong>数据范围</strong></p>
</blockquote>
<p>$1 \le n \le 10^5$,</p>
<p>$1\le a_i\le10^9$</p>
<blockquote>
<p>  <strong>输入样例</strong></p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">2</span><br><span class="line">2 3</span><br></pre></td></tr></table></figure>
<blockquote>
<p>  <strong>输出样例</strong></p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Yes</span><br></pre></td></tr></table></figure>
<blockquote>
<p>  <strong>实现代码</strong></p>
</blockquote>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="type">int</span> n, t, x = <span class="number">0</span>;</span><br><span class="line">    cin &gt;&gt; n;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; n; ++i) &#123;</span><br><span class="line">        cin &gt;&gt; t;</span><br><span class="line">        x ^= t;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (x != <span class="number">0</span>) cout &lt;&lt; <span class="string">&quot;Yes\n&quot;</span>;</span><br><span class="line">    <span class="keyword">else</span> cout &lt;&lt; <span class="string">&quot;No\n&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="台阶-Nim游戏"><a href="#台阶-Nim游戏" class="headerlink" title="台阶-Nim游戏"></a>台阶-Nim游戏</h3><blockquote>
<p>  <strong>题目描述</strong></p>
</blockquote>
<p>现在，有一个$n$级台阶的楼梯，每级台阶上都有若干个石子，其中第$i$级台阶上有$a_i$个石子（$i \ge 1$）。</p>
<p>两位玩家轮流操作，每次操作可以从任意一级台阶上拿若干个石子，放到下一级台阶中（不能不拿）。</p>
<p>已经拿到地面上的石子不能再拿，最后无法进行操作的人视为失败。</p>
<p>问如果两人都采用最优策略，先手是否必胜。</p>
<blockquote>
<p>  <strong>输入格式</strong></p>
</blockquote>
<p>第一行包含整数$n$。</p>
<p>第二行包含$n$个数字$a1,a_2,\cdots,a_n$，其中第$i$个数字表示第$i$堆石子的数量。</p>
<blockquote>
<p>  <strong>输出格式</strong></p>
</blockquote>
<p>如果先手方必胜，则输出”Yes”。</p>
<p>否则，输出”No”。</p>
<blockquote>
<p>  <strong>数据范围</strong></p>
</blockquote>
<p>$1 \le n \le 10^5$,</p>
<p>$1\le a_i\le10^9$</p>
<blockquote>
<p>  <strong>输入样例</strong></p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">3</span><br><span class="line">2 1 3</span><br></pre></td></tr></table></figure>
<blockquote>
<p>  <strong>输出样例</strong></p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Yes</span><br></pre></td></tr></table></figure>
<blockquote>
<p>  <strong>实现代码</strong></p>
</blockquote>
<p>根据样例：</p>
<p>最终对手输的情况为：0 0 0，则我的最后一次操作为：从1 0 0变为0 0 0，则我需要保证对手的上一次操作为0 1 0(若对手面对0 3 0时，操作为1 2 0，则我操作为0 2 0，对手再操作为1 1 0，我再操作为0 1 0，所以倒数的情况一定为0 1 0)。即操作后的情况是奇数行的异或值要为0.</p>
<p>这里可以推出结论：$a_1 \oplus a_3\oplus a_5 \oplus \cdots \oplus a_n = x \not= 0$（奇数台阶异或不为零）则先手必胜</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="type">int</span> n, t, res = <span class="number">0</span>;</span><br><span class="line">    cin &gt;&gt; n;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; ++i) &#123;</span><br><span class="line">        cin &gt;&gt; t;</span><br><span class="line">        <span class="keyword">if</span> (i &amp; <span class="number">1</span>) res ^= t;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (res) <span class="built_in">puts</span>(<span class="string">&quot;Yes&quot;</span>);</span><br><span class="line">    <span class="keyword">else</span> <span class="built_in">puts</span>(<span class="string">&quot;No&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="集合-Nim游戏"><a href="#集合-Nim游戏" class="headerlink" title="集合-Nim游戏"></a>集合-Nim游戏</h3><blockquote>
<p>  <strong>题目描述</strong></p>
</blockquote>
<p>给定$n$堆石子以及一个由$k$个不同正整数构成的数字集合$S$。</p>
<p>现有两位玩家轮流操作，每次操作可以冲任意一堆石子中拿取石子，每次拿取的石子数量必须包含于集合$S$，最后无法进行操作的人视为失败。</p>
<p>问如果两人都采用最优策略，先手是否必胜。</p>
<blockquote>
<p>  <strong>输入格式</strong></p>
</blockquote>
<p>第一行包含整数$k$，表示数字集合$S$中数字的个数。</p>
<p>第二行包含$k$个数字，其中第$i$个整数表示数字集合$S$中的第$i$个数$s_i$。</p>
<p>第三行包含整数$n$。</p>
<p>第四行包含$n$个整数，其中第$i$个整数表示第$i$堆石子的数量$h_i$。</p>
<blockquote>
<p>  <strong>输出格式</strong></p>
</blockquote>
<p>如果先手方必胜，则输出”Yes”。</p>
<p>否则，输出”No”。</p>
<blockquote>
<p>  <strong>数据范围</strong></p>
</blockquote>
<p>$1 \le n,k \le 100$,</p>
<p>$1\le s_i,h_i \le 10000$</p>
<blockquote>
<p>  <strong>输入样例</strong></p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">2</span><br><span class="line">2 5</span><br><span class="line">3</span><br><span class="line">2 4 7</span><br></pre></td></tr></table></figure>
<blockquote>
<p>  <strong>输出样例</strong></p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Yes</span><br></pre></td></tr></table></figure>
<blockquote>
<p>  <strong>实现代码</strong></p>
</blockquote>
<p>根据样例，要拿掉2 4 7 三堆石子，因此可以看成三个有向图游戏，即求三个sg函数值（$sg(2),sg(4),sg(7)$）然后根据Nim游戏的结论（初始异或值不为0则必胜），对三个sg函数值进行异或计算，再判断结果。</p>
<p>前面已经讲过sg函数的计算了，这里举例计算：</p>
<p>先看后继节点：</p>
<p>7-&gt;5-&gt;3-&gt;1</p>
<p>   5-&gt;0</p>
<p>7-&gt;2-&gt;0</p>
<p>（7取出2颗变为5，7取出5颗变为2，因此7的后继节点为5和2…）</p>
<p>sg(0) = mex($\varnothing$) = 0 (0没有后继节点)</p>
<p>sg(1) = mex($\varnothing$) = 0 (1没有后继节点)</p>
<p>sg(2) = mex({sg(0)}) = mex({0}) = 1</p>
<p>sg(3) = mex({sg(1)}) = mex({0}) = 1</p>
<p>sg(5) = mex({sg(3), sg(0)}) = mex({1, 0}) = 2</p>
<p>sg(7) = mex({sg(5), sg(2)}) = mex({2, 1}) = 0</p>
<p>到这里求出了sg(7)=2，sg(2)=0</p>
<p>4-&gt;2-&gt;2-&gt;0</p>
<p>sg(4)=mex({sg(2)})=mex({1}) = 0</p>
<p>到这里求出了sg(7)=1，sg(2)=0，sg(4)=0</p>
<p>最终异或值为1。</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;unordered_set&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N = <span class="number">110</span>, M = <span class="number">10010</span>;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> n, m;</span><br><span class="line"><span class="type">int</span> s[N], f[M]; <span class="comment">// s为集合元素，f[i]为sg(i)</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">sg</span><span class="params">(<span class="type">int</span> x)</span> </span>&#123; <span class="comment">// 记忆化搜索求f[x]</span></span><br><span class="line">    <span class="keyword">if</span> (f[x] != <span class="number">-1</span>) <span class="keyword">return</span> f[x]; <span class="comment">// 保证每个状态只被算一次</span></span><br><span class="line">    unordered_set&lt;<span class="type">int</span>&gt; S; <span class="comment">// 这个集合存储的是sg(y1),sg(y2)...sg(yk)</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; m; ++i) &#123;</span><br><span class="line">        <span class="type">int</span> sum = s[i];</span><br><span class="line">        <span class="keyword">if</span> (x &gt;= sum) S.<span class="built_in">insert</span>(<span class="built_in">sg</span>(x-sum));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 从0开始找，第一个不在集合中的数就是mex(S)，即sg(x)</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; ; ++i) <span class="keyword">if</span> (!S.<span class="built_in">count</span>(i)) <span class="keyword">return</span> f[x] = i;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    cin &gt;&gt; m;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; m; ++i) cin &gt;&gt; s[i];</span><br><span class="line"></span><br><span class="line">    cin &gt;&gt; n;</span><br><span class="line">    <span class="built_in">memset</span>(f, <span class="number">-1</span>, <span class="built_in">sizeof</span>(f));</span><br><span class="line"></span><br><span class="line">    <span class="type">int</span> res = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; n; ++i) &#123;</span><br><span class="line">        <span class="type">int</span> x;</span><br><span class="line">        cin &gt;&gt; x;</span><br><span class="line">        res ^= <span class="built_in">sg</span>(x);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (res) cout &lt;&lt; <span class="string">&quot;Yes\n&quot;</span>;</span><br><span class="line">    <span class="keyword">else</span> cout &lt;&lt; <span class="string">&quot;No\n&quot;</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="拆分-Nim游戏"><a href="#拆分-Nim游戏" class="headerlink" title="拆分-Nim游戏"></a>拆分-Nim游戏</h3><blockquote>
<p>  <strong>题目描述</strong></p>
</blockquote>
<p>给定$n$堆石子，两位玩家轮流操作，每次操作可以取走其中的一堆石子，然后放入两堆<strong>规模更小</strong>的石子（新堆规模可以为0，且两个新堆堆石子总数可以大于取走的那堆石子数），最后无法进行操作的人视为失败。</p>
<p>问如果两人都采用最优策略，先手是否必胜。</p>
<blockquote>
<p>  <strong>输入格式</strong></p>
</blockquote>
<p>第一行包含整数$n$。</p>
<p>第二行包含$n$个数字$a1,a_2,\cdots,a_n$，其中第$i$个数字表示第$i$堆石子的数量。</p>
<blockquote>
<p>  <strong>输出格式</strong></p>
</blockquote>
<p>如果先手方必胜，则输出”Yes”。</p>
<p>否则，输出”No”。</p>
<blockquote>
<p>  <strong>数据范围</strong></p>
</blockquote>
<p>$1 \le n,a_i \le 100$</p>
<blockquote>
<p>  <strong>输入样例</strong></p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">2</span><br><span class="line">2 3</span><br></pre></td></tr></table></figure>
<blockquote>
<p>  <strong>输出样例</strong></p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Yes</span><br></pre></td></tr></table></figure>
<blockquote>
<p>  <strong>实现代码</strong></p>
</blockquote>
<p>假设取$a_i$，可以分为两堆$b_i, b_j$，即$sg(a_i) = sg(b_i,b_j) = sg(b_i) \oplus sg(b_j)$</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;unordered_set&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N = <span class="number">110</span>;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> f[N];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">sg</span><span class="params">(<span class="type">int</span> x)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (f[x] != <span class="number">-1</span>) <span class="keyword">return</span> f[x];</span><br><span class="line"></span><br><span class="line">    unordered_set&lt;<span class="type">int</span>&gt; S;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; x; ++i) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>; j &lt;= i; ++j) &#123;</span><br><span class="line">            S.<span class="built_in">insert</span>(<span class="built_in">sg</span>(i) ^ <span class="built_in">sg</span>(j));</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; ; ++i)</span><br><span class="line">        <span class="keyword">if</span> (!S.<span class="built_in">count</span>(i)) </span><br><span class="line">            <span class="keyword">return</span> f[x] = i;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="type">int</span> n;</span><br><span class="line">    cin &gt;&gt; n;</span><br><span class="line">    <span class="built_in">memset</span>(f, <span class="number">-1</span>, <span class="built_in">sizeof</span>(f));</span><br><span class="line"></span><br><span class="line">    <span class="type">int</span> res = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; n; ++i) &#123;</span><br><span class="line">        <span class="type">int</span> x;</span><br><span class="line">        cin &gt;&gt; x;</span><br><span class="line">        res ^= <span class="built_in">sg</span>(x);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (res) cout &lt;&lt; <span class="string">&quot;Yes\n&quot;</span>;</span><br><span class="line">    <span class="keyword">else</span> cout &lt;&lt; <span class="string">&quot;No\n&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="http://yongruizhang.cn">YongRui Zhang</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="http://yongruizhang.cn/posts/3523095624.html">http://yongruizhang.cn/posts/3523095624.html</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" rel="external nofollow noreferrer" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="http://yongruizhang.cn" target="_blank">秋白's Blog</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E5%92%8C%E7%AE%97%E6%B3%95/">数据结构和算法</a><a class="post-meta__tags" href="/tags/C/">C++</a><a class="post-meta__tags" href="/tags/%E6%95%B0%E8%AE%BA/">数论</a></div><div class="post_share"><div class="social-share" data-image="https://zyr-blog-image.oss-cn-beijing.aliyuncs.com/img102.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><div class="post-reward"><div class="reward-button"><i class="fas fa-qrcode"></i> 打赏</div><div class="reward-main"><ul class="reward-all"><li class="reward-item"><a href="https://zyr-blog-image.oss-cn-beijing.aliyuncs.com/img/blog-img-main/weixin.jpeg" rel="external nofollow noreferrer" target="_blank"><img class="post-qr-code-img" src="https://zyr-blog-image.oss-cn-beijing.aliyuncs.com/img/blog-img-main/weixin.jpeg" alt="wechat"/></a><div class="post-qr-code-desc">wechat</div></li><li class="reward-item"><a href="https://zyr-blog-image.oss-cn-beijing.aliyuncs.com/img/blog-img-main/alipay.jpeg" rel="external nofollow noreferrer" target="_blank"><img class="post-qr-code-img" src="https://zyr-blog-image.oss-cn-beijing.aliyuncs.com/img/blog-img-main/alipay.jpeg" alt="alipay"/></a><div class="post-qr-code-desc">alipay</div></li></ul></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/posts/1539568593.html" title="最近公共祖先(LCA)"><img class="cover" src="https://zyr-blog-image.oss-cn-beijing.aliyuncs.com/img/blog-img-main/%E6%88%AA%E5%B1%8F2024-02-20%2011.07.05.png" onerror="onerror=null;src='https://zyr-blog-image.oss-cn-beijing.aliyuncs.com/img/blog-img-main/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">最近公共祖先(LCA)</div></div></a></div><div class="next-post pull-right"><a href="/posts/2864584994.html" title="重定向输入"><img class="cover" src="https://zyr-blog-image.oss-cn-beijing.aliyuncs.com/img104.jpg" onerror="onerror=null;src='https://zyr-blog-image.oss-cn-beijing.aliyuncs.com/img/blog-img-main/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">重定向输入</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>相关推荐</span></div><div class="relatedPosts-list"><div><a href="/posts/1765123828.html" title="01背包问题"><img class="cover" src="https://www.biaodianfu.com/wp-content/uploads/2020/10/Knapsack-problem.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2023-03-03</div><div class="title">01背包问题</div></div></a></div><div><a href="/posts/71180092.html" title="132模式"><img class="cover" src="https://th.bing.com/th/id/R.cd417258dd040b15ee7f80446286f8cd?rik=h4u772yt8Y90Eg&riu=http%3a%2f%2fclipart-library.com%2fimage_gallery2%2fC-PNG-Clipart.png&ehk=7M8vJglJPBqE2DoDSlx7kq%2bsDBm23N4ni81JJ%2fWF%2bj8%3d&risl=&pid=ImgRaw&r=0&sres=1&sresct=1" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2023-02-16</div><div class="title">132模式</div></div></a></div><div><a href="/posts/716459272.html" title="中序和后序重构二叉树"><img class="cover" src="https://ts1.cn.mm.bing.net/th/id/R-C.59657050856735523d338deb29bd5199?rik=2eX8qAB6O8vYHQ&riu=http%3a%2f%2fbpic.588ku.com%2felement_pic%2f19%2f03%2f21%2f93ebf84aabc267a47c8ebfaf9d9b2be1.jpg&ehk=yAhzmYDPkljmxbOsnNanc426m1RSHRSAUfrQsdB9dOc%3d&risl=&pid=ImgRaw&r=0" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2023-02-22</div><div class="title">中序和后序重构二叉树</div></div></a></div><div><a href="/posts/3498516849.html" title="分割数组以得到最大和"><img class="cover" src="https://zyr-blog-image.oss-cn-beijing.aliyuncs.com/img101.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2023-03-04</div><div class="title">分割数组以得到最大和</div></div></a></div><div><a href="/posts/3405577485.html" title="动态规划基础"><img class="cover" src="https://th.bing.com/th/id/R.2a39cfd08be2fee0a360ef8a518c3502?rik=EqHQZt1z%2bz5cxA&riu=http%3a%2f%2fphotocdn.sohu.com%2f20151117%2fmp42233126_1447732179240_1_th.jpeg&ehk=ZVSU%2f9HBjGNEPw6Y7YArqP0j1EYyy50aoJzhJiGUH%2fM%3d&risl=&pid=ImgRaw&r=0" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2023-03-04</div><div class="title">动态规划基础</div></div></a></div><div><a href="/posts/795397410.html" title="区间合并"><img class="cover" src="https://th.bing.com/th/id/R.cd417258dd040b15ee7f80446286f8cd?rik=h4u772yt8Y90Eg&riu=http%3a%2f%2fclipart-library.com%2fimage_gallery2%2fC-PNG-Clipart.png&ehk=7M8vJglJPBqE2DoDSlx7kq%2bsDBm23N4ni81JJ%2fWF%2bj8%3d&risl=&pid=ImgRaw&r=0&sres=1&sresct=1" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2023-02-15</div><div class="title">区间合并</div></div></a></div></div></div><hr/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> 评论</span></div></div><div class="comment-wrap"><div><div id="twikoo-wrap"></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="https://zyr-blog-image.oss-cn-beijing.aliyuncs.com/img/blog-img-main/favicon.png" onerror="this.onerror=null;this.src='https://zyr-blog-image.oss-cn-beijing.aliyuncs.com/img/blog-img-main/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">秋白</div><div class="author-info__description">埋头学习 抬头恋爱</div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">106</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">62</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">71</div></a></div><a id="card-info-btn" target="_blank" rel="noopener external nofollow noreferrer" href="https://github.com/yongruizhang"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons is-center"><a class="social-icon" href="https://github.com/yongruizhang" rel="external nofollow noreferrer" target="_blank" title="Github"><i class="fab fa-github"></i></a><a class="social-icon" href="mailto:yongruizhang@gmail.com" rel="external nofollow noreferrer" target="_blank" title="Email"><i class="fas fa-envelope"></i></a><a class="social-icon" href="https://space.bilibili.com/367319940?spm_id_from=333.337.0.0" rel="external nofollow noreferrer" target="_blank" title="bilibili"><i class="fa-brands fa-bilibili"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content"><p style="text-indent:2em;">我是数据科学与大数据专业本科生。<br/></p><p style="text-indent:2em;">目前主要学习AR、CV、大数据开发，数学建模，机器学习，算法。之前浅学过Java后端，有一点前端基础。<br/></p><p style="text-indent:2em;">为了您的体验，没有设置复制权限，您可以复制文章内容和代码来做笔记等，但您要发布文章请注明内容出处，请遵循开源原则🤝</p><p style="text-indent:2em;">如果文章内容有错误，或者版本等问题拜托在评论区留言，为后来人搭桥。感谢🙏</p><p style="text-indent:2em;">由于我是利用电脑端Safari浏览器写的相关样式，所以不同平台的效果可能不同，不推荐使用手机访问博客（我没怎么适配，可能会有些显示问题）。前端技术有限😅<br/></p></div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%95%B0%E8%AE%BA"><span class="toc-text">数论</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%B4%A8%E6%95%B0%EF%BC%88%E7%B4%A0%E6%95%B0%EF%BC%89"><span class="toc-text">质数（素数）</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%B4%A8%E6%95%B0%E7%9A%84%E5%88%A4%E5%AE%9A%E2%80%94%E2%80%94%E8%AF%95%E9%99%A4%E6%B3%95"><span class="toc-text">质数的判定——试除法</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%86%E8%A7%A3%E8%B4%A8%E5%9B%A0%E6%95%B0%E2%80%94%E2%80%94%E8%AF%95%E9%99%A4%E6%B3%95"><span class="toc-text">分解质因数——试除法</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AD%9B%E8%B4%A8%E6%95%B0"><span class="toc-text">筛质数</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%BA%A6%E6%95%B0"><span class="toc-text">约数</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%AF%95%E9%99%A4%E6%B3%95%E6%B1%82%E7%BA%A6%E6%95%B0"><span class="toc-text">试除法求约数</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BA%A6%E6%95%B0%E4%B8%AA%E6%95%B0"><span class="toc-text">约数个数</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%80%A7%E8%B4%A8"><span class="toc-text">性质</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BA%A6%E6%95%B0%E4%B9%8B%E5%92%8C"><span class="toc-text">约数之和</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%80%A7%E8%B4%A8-1"><span class="toc-text">性质</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9C%80%E5%A4%A7%E5%85%AC%E7%BA%A6%E6%95%B0-%E6%AC%A7%E5%87%A0%E9%87%8C%E5%BE%97%E7%AE%97%E6%B3%95%E3%80%81%E8%BE%97%E8%BD%AC%E7%9B%B8%E9%99%A4%E6%B3%95"><span class="toc-text">最大公约数(欧几里得算法、辗转相除法)</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%AC%A7%E6%8B%89%E5%87%BD%E6%95%B0"><span class="toc-text">欧拉函数</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%AC%A7%E6%8B%89%E5%87%BD%E6%95%B0-1"><span class="toc-text">欧拉函数</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AD%9B%E6%B3%95%E6%B1%82%E6%AC%A7%E6%8B%89%E5%87%BD%E6%95%B0"><span class="toc-text">筛法求欧拉函数</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%B1%82%E6%AC%A7%E6%8B%89%E5%87%BD%E6%95%B0%E4%BD%9C%E7%94%A8"><span class="toc-text">求欧拉函数作用</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%BF%AB%E9%80%9F%E5%B9%82"><span class="toc-text">快速幂</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%BF%AB%E9%80%9F%E5%B9%82-1"><span class="toc-text">快速幂</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%BF%AB%E9%80%9F%E5%B9%82%E6%B1%82%E9%80%86%E5%85%83"><span class="toc-text">快速幂求逆元</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%89%A9%E5%B1%95%E6%AC%A7%E5%87%A0%E9%87%8C%E5%BE%97%E7%AE%97%E6%B3%95"><span class="toc-text">扩展欧几里得算法</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%89%A9%E5%B1%95%E6%AC%A7%E5%87%A0%E9%87%8C%E5%BE%97%E7%AE%97%E6%B3%95-1"><span class="toc-text">扩展欧几里得算法</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BA%BF%E6%80%A7%E5%90%8C%E4%BD%99%E6%96%B9%E7%A8%8B"><span class="toc-text">线性同余方程</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%AD%E5%9B%BD%E5%89%A9%E4%BD%99%E5%AE%9A%E7%90%86"><span class="toc-text">中国剩余定理</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%A1%A8%E8%BE%BE%E6%95%B4%E6%95%B0%E7%9A%84%E5%A5%87%E6%80%AA%E6%96%B9%E5%BC%8F"><span class="toc-text">表达整数的奇怪方式</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%AB%98%E6%96%AF%E6%B6%88%E5%85%83"><span class="toc-text">高斯消元</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%AB%98%E6%96%AF%E6%B6%88%E5%85%83%E8%A7%A3%E7%BA%BF%E6%80%A7%E6%96%B9%E7%A8%8B%E7%BB%84"><span class="toc-text">高斯消元解线性方程组</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%AB%98%E6%96%AF%E6%B6%88%E5%85%83%E8%A7%A3%E5%BC%82%E6%88%96%E7%BA%BF%E6%80%A7%E6%96%B9%E7%A8%8B%E7%BB%84"><span class="toc-text">高斯消元解异或线性方程组</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%BB%84%E5%90%88%E6%95%B0"><span class="toc-text">组合数</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%B1%82%E7%BB%84%E5%90%88%E6%95%B0I"><span class="toc-text">求组合数I</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%B1%82%E7%BB%84%E5%90%88%E6%95%B0II"><span class="toc-text">求组合数II</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%B1%82%E7%BB%84%E5%90%88%E6%95%B0III"><span class="toc-text">求组合数III</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%B1%82%E7%BB%84%E5%90%88%E6%95%B0IV"><span class="toc-text">求组合数IV</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%BB%A1%E8%B6%B3%E6%9D%A1%E4%BB%B6%E7%9A%8401%E5%BA%8F%E5%88%97"><span class="toc-text">满足条件的01序列</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AE%B9%E6%96%A5%E5%8E%9F%E7%90%86"><span class="toc-text">容斥原理</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%83%BD%E8%A2%AB%E6%95%B4%E9%99%A4%E7%9A%84%E6%95%B0"><span class="toc-text">能被整除的数</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%AE%80%E5%8D%95%E5%8D%9A%E5%BC%88%E8%AE%BA"><span class="toc-text">简单博弈论</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Nim%E6%B8%B8%E6%88%8F"><span class="toc-text">Nim游戏</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8F%B0%E9%98%B6-Nim%E6%B8%B8%E6%88%8F"><span class="toc-text">台阶-Nim游戏</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%9B%86%E5%90%88-Nim%E6%B8%B8%E6%88%8F"><span class="toc-text">集合-Nim游戏</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%8B%86%E5%88%86-Nim%E6%B8%B8%E6%88%8F"><span class="toc-text">拆分-Nim游戏</span></a></li></ol></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/posts/2768249503.html" title="2023年第十四届蓝桥杯省赛C/C++B组题解"><img src="https://zyr-blog-image.oss-cn-beijing.aliyuncs.com/img/blog-img-main/img.jpg" onerror="this.onerror=null;this.src='https://zyr-blog-image.oss-cn-beijing.aliyuncs.com/img/blog-img-main/404.jpg'" alt="2023年第十四届蓝桥杯省赛C/C++B组题解"/></a><div class="content"><a class="title" href="/posts/2768249503.html" title="2023年第十四届蓝桥杯省赛C/C++B组题解">2023年第十四届蓝桥杯省赛C/C++B组题解</a><time datetime="2024-02-21T13:55:35.000Z" title="发表于 2024-02-21 21:55:35">2024-02-21</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/2697614349.html" title="树上前缀和及树上差分"><img src="https://zyr-blog-image.oss-cn-beijing.aliyuncs.com/img108.jpg" onerror="this.onerror=null;this.src='https://zyr-blog-image.oss-cn-beijing.aliyuncs.com/img/blog-img-main/404.jpg'" alt="树上前缀和及树上差分"/></a><div class="content"><a class="title" href="/posts/2697614349.html" title="树上前缀和及树上差分">树上前缀和及树上差分</a><time datetime="2024-02-21T12:31:53.000Z" title="发表于 2024-02-21 20:31:53">2024-02-21</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/1539568593.html" title="最近公共祖先(LCA)"><img src="https://zyr-blog-image.oss-cn-beijing.aliyuncs.com/img/blog-img-main/%E6%88%AA%E5%B1%8F2024-02-20%2011.07.05.png" onerror="this.onerror=null;this.src='https://zyr-blog-image.oss-cn-beijing.aliyuncs.com/img/blog-img-main/404.jpg'" alt="最近公共祖先(LCA)"/></a><div class="content"><a class="title" href="/posts/1539568593.html" title="最近公共祖先(LCA)">最近公共祖先(LCA)</a><time datetime="2024-02-21T02:51:09.000Z" title="发表于 2024-02-21 10:51:09">2024-02-21</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/3523095624.html" title="数论基础"><img src="https://zyr-blog-image.oss-cn-beijing.aliyuncs.com/img102.jpg" onerror="this.onerror=null;this.src='https://zyr-blog-image.oss-cn-beijing.aliyuncs.com/img/blog-img-main/404.jpg'" alt="数论基础"/></a><div class="content"><a class="title" href="/posts/3523095624.html" title="数论基础">数论基础</a><time datetime="2024-02-18T05:25:58.000Z" title="发表于 2024-02-18 13:25:58">2024-02-18</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/2864584994.html" title="重定向输入"><img src="https://zyr-blog-image.oss-cn-beijing.aliyuncs.com/img104.jpg" onerror="this.onerror=null;this.src='https://zyr-blog-image.oss-cn-beijing.aliyuncs.com/img/blog-img-main/404.jpg'" alt="重定向输入"/></a><div class="content"><a class="title" href="/posts/2864584994.html" title="重定向输入">重定向输入</a><time datetime="2023-12-07T08:09:26.000Z" title="发表于 2023-12-07 16:09:26">2023-12-07</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2023 - 2024 By 秋白</div><div class="footer_custom_text"><a target="_blank" rel="noopener external nofollow noreferrer" href="https://beian.miit.gov.cn/">蜀ICP备2023012316号-1</a><br/>埋头学习 抬头恋爱<br/>本博客为个人博客，内容仅供学习参考<br/>如果文章帮到您了，或者您觉得我比较有趣请给我评论或打赏～</div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="translateLink" type="button" title="简繁转换">繁</button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="chat_btn" type="button" title="聊天"><i class="fas fa-sms"></i></button><a id="to_comment" href="#post-comment" title="直达评论"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">搜索</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="is-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  数据库加载中</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"/></div></div><hr/><div id="local-search-results"></div></div></div><div id="search-mask"></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.umd.min.js"></script><script src="https://cdn.jsdelivr.net/npm/instant.page/instantpage.min.js" type="module"></script><script src="https://cdn.jsdelivr.net/npm/vanilla-lazyload/dist/lazyload.iife.min.js"></script><script src="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.js"></script><script>function panguFn () {
  if (typeof pangu === 'object') pangu.autoSpacingPage()
  else {
    getScript('https://cdn.jsdelivr.net/npm/pangu/dist/browser/pangu.min.js')
      .then(() => {
        pangu.autoSpacingPage()
      })
  }
}

function panguInit () {
  if (false){
    GLOBAL_CONFIG_SITE.isPost && panguFn()
  } else {
    panguFn()
  }
}

document.addEventListener('DOMContentLoaded', panguInit)</script><script src="/js/search/local-search.js"></script><div class="js-pjax"><script>if (!window.MathJax) {
  window.MathJax = {
    tex: {
      inlineMath: [ ['$','$'], ["\\(","\\)"]],
      tags: 'ams'
    },
    chtml: {
      scale: 1.1
    },
    options: {
      renderActions: {
        findScript: [10, doc => {
          for (const node of document.querySelectorAll('script[type^="math/tex"]')) {
            const display = !!node.type.match(/; *mode=display/)
            const math = new doc.options.MathItem(node.textContent, doc.inputJax[0], display)
            const text = document.createTextNode('')
            node.parentNode.replaceChild(text, node)
            math.start = {node: text, delim: '', n: 0}
            math.end = {node: text, delim: '', n: 0}
            doc.math.push(math)
          }
        }, ''],
        insertScript: [200, () => {
          document.querySelectorAll('mjx-container').forEach(node => {
            if (node.hasAttribute('display')) {
              btf.wrap(node, 'div', { class: 'mathjax-overflow' })
            } else {
              btf.wrap(node, 'span', { class: 'mathjax-overflow' })
            }
          });
        }, '', false]
      }
    }
  }
  
  const script = document.createElement('script')
  script.src = 'https://cdn.jsdelivr.net/npm/mathjax/es5/tex-mml-chtml.min.js'
  script.id = 'MathJax-script'
  script.async = true
  document.head.appendChild(script)
} else {
  MathJax.startup.document.state(0)
  MathJax.texReset()
  MathJax.typeset()
}</script><script>(()=>{
  const init = () => {
    twikoo.init(Object.assign({
      el: '#twikoo-wrap',
      envId: 'http://101.43.224.206:8099',
      region: '',
      onCommentLoaded: function () {
        btf.loadLightbox(document.querySelectorAll('#twikoo .tk-content img:not(.tk-owo-emotion)'))
      }
    }, null))
  }

  const getCount = () => {
    const countELement = document.getElementById('twikoo-count')
    if(!countELement) return
    twikoo.getCommentsCount({
      envId: 'http://101.43.224.206:8099',
      region: '',
      urls: [window.location.pathname],
      includeReply: false
    }).then(function (res) {
      countELement.innerText = res[0].count
    }).catch(function (err) {
      console.error(err);
    });
  }

  const runFn = () => {
    init()
    GLOBAL_CONFIG_SITE.isPost && getCount()
  }

  const loadTwikoo = () => {
    if (typeof twikoo === 'object') {
      setTimeout(runFn,0)
      return
    } 
    getScript('https://cdn.jsdelivr.net/npm/twikoo/dist/twikoo.all.min.js').then(runFn)
  }

  if ('Twikoo' === 'Twikoo' || !true) {
    if (true) btf.loadComment(document.getElementById('twikoo-wrap'), loadTwikoo)
    else loadTwikoo()
  } else {
    window.loadOtherComment = () => {
      loadTwikoo()
    }
  }
})()</script></div><script async src="https://cdn.jsdelivr.net/gh/zhheo/twikoo@dev/dist/twikoo.all.min.js"><script src="https://cdn.staticfile.org/twikoo/1.6.4/twikoo.all.min.js"></script><script charset="UTF-8" id="LA_COLLECT" src="//sdk.51.la/js-sdk-pro.min.js"></script><script>LA.init({id:"3HZNrBGiHwNPYZ7J",ck:"3HZNrBGiHwNPYZ7J"})</script><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/activate-power-mode.min.js"></script><script>POWERMODE.colorful = true;
POWERMODE.shake = false;
POWERMODE.mobile = false;
document.body.addEventListener('input', POWERMODE);
</script><script>window.$crisp = [];
window.CRISP_WEBSITE_ID = "52b81d8c-40b2-40bc-bd82-3bceb709cf4b";
(function () {
  d = document;
  s = d.createElement("script");
  s.src = "https://client.crisp.chat/l.js";
  s.async = 1;
  d.getElementsByTagName("head")[0].appendChild(s);
})();
$crisp.push(["safe", true])

if (true) {
  $crisp.push(["do", "chat:hide"])
  $crisp.push(["on", "chat:closed", function() {
    $crisp.push(["do", "chat:hide"])
  }])
  var chatBtnFn = () => {
    var chatBtn = document.getElementById("chat_btn")
    chatBtn.addEventListener("click", function(){
      $crisp.push(["do", "chat:show"])
      $crisp.push(["do", "chat:open"])

    });
  }
  chatBtnFn()
} else {
  if (true) {
    function chatBtnHide () {
      $crisp.push(["do", "chat:hide"])
    }
    function chatBtnShow () {
      $crisp.push(["do", "chat:show"])
    }
  }
}</script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.js"></script><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/metingjs/dist/Meting.min.js"></script><script src="https://cdn.jsdelivr.net/npm/pjax/pjax.min.js"></script><script>let pjaxSelectors = ["head > title","#config-diff","#body-wrap","#rightside-config-hide","#rightside-config-show",".js-pjax"]

var pjax = new Pjax({
  elements: 'a:not([target="_blank"])',
  selectors: pjaxSelectors,
  cacheBust: false,
  analytics: false,
  scrollRestoration: false
})

document.addEventListener('pjax:send', function () {

  // removeEventListener scroll 
  window.tocScrollFn && window.removeEventListener('scroll', window.tocScrollFn)
  window.scrollCollect && window.removeEventListener('scroll', scrollCollect)

  document.getElementById('rightside').style.cssText = "opacity: ''; transform: ''"
  
  if (window.aplayers) {
    for (let i = 0; i < window.aplayers.length; i++) {
      if (!window.aplayers[i].options.fixed) {
        window.aplayers[i].destroy()
      }
    }
  }

  typeof typed === 'object' && typed.destroy()

  //reset readmode
  const $bodyClassList = document.body.classList
  $bodyClassList.contains('read-mode') && $bodyClassList.remove('read-mode')

  typeof disqusjs === 'object' && disqusjs.destroy()
})

document.addEventListener('pjax:complete', function () {
  window.refreshFn()

  document.querySelectorAll('script[data-pjax]').forEach(item => {
    const newScript = document.createElement('script')
    const content = item.text || item.textContent || item.innerHTML || ""
    Array.from(item.attributes).forEach(attr => newScript.setAttribute(attr.name, attr.value))
    newScript.appendChild(document.createTextNode(content))
    item.parentNode.replaceChild(newScript, item)
  })

  GLOBAL_CONFIG.islazyload && window.lazyLoadInstance.update()

  typeof chatBtnFn === 'function' && chatBtnFn()
  typeof panguInit === 'function' && panguInit()

  // google analytics
  typeof gtag === 'function' && gtag('config', '', {'page_path': window.location.pathname});

  // baidu analytics
  typeof _hmt === 'object' && _hmt.push(['_trackPageview',window.location.pathname]);

  typeof loadMeting === 'function' && document.getElementsByClassName('aplayer').length && loadMeting()

  // prismjs
  typeof Prism === 'object' && Prism.highlightAll()
})

document.addEventListener('pjax:error', (e) => {
  if (e.request.status === 404) {
    pjax.loadUrl('/404.html')
  }
})</script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div><script async>window.onload=function(){var a=document.createElement('script'),b=document.getElementsByTagName('script')[0];a.type='text/javascript',a.async=!0,a.src='/sw-register.js?v='+Date.now(),b.parentNode.insertBefore(a,b)};</script></body></html>